<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOM6: mom_diag_mediator Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacemom__diag__mediator.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mom_diag_mediator Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A group of 1D axes that comprise a 1D/2D/3D mesh.  <a href="structmom__diag__mediator_1_1axes__grp.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following data type a list of diagnostic fields an their variants, as well as variables that control the handling of model output.  <a href="structmom__diag__mediator_1_1diag__ctrl.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This type is used to represent a diagnostic at the diag_mediator level. There can be both 'primary' and 'seconday' diagnostics. The primaries reside in the diag_csdiags array. They have an id which is an index into this array. The secondaries are 'variations' on the primary diagnostic. For example the CMOR diagnostics are secondary. The secondary diagnostics are kept in a list with the primary diagnostic as the head.  <a href="structmom__diag__mediator_1_1diag__type.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacemom__diag__mediator_1_1post__data.html">post_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4d8d23e602166167b393e19453ded5bf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a4d8d23e602166167b393e19453ded5bf">set_axes_info</a> (G, GV, param_file, diag_cs, set_vertical)</td></tr>
<tr class="memdesc:a4d8d23e602166167b393e19453ded5bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up diagnostics axes.  <a href="#a4d8d23e602166167b393e19453ded5bf">More...</a><br /></td></tr>
<tr class="separator:a4d8d23e602166167b393e19453ded5bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2795a8a8618f945a9a0830f461d3e42d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a2795a8a8618f945a9a0830f461d3e42d">diag_register_area_ids</a> (diag_cs, id_area_t, id_area_q)</td></tr>
<tr class="memdesc:a2795a8a8618f945a9a0830f461d3e42d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches the id of cell areas to axes groups for use with cell_measures.  <a href="#a2795a8a8618f945a9a0830f461d3e42d">More...</a><br /></td></tr>
<tr class="separator:a2795a8a8618f945a9a0830f461d3e42d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7238cbbe68b1e044c0bc081534159801"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a7238cbbe68b1e044c0bc081534159801">diag_register_volume_ids</a> (diag_cs, id_vol_t)</td></tr>
<tr class="memdesc:a7238cbbe68b1e044c0bc081534159801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches the id of cell volumes to axes groups for use with cell_measures.  <a href="#a7238cbbe68b1e044c0bc081534159801">More...</a><br /></td></tr>
<tr class="separator:a7238cbbe68b1e044c0bc081534159801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f767ec24a860cb71cae264560272a8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ab9f767ec24a860cb71cae264560272a8">define_axes_group</a> (diag_cs, handles, axes, nz, vertical_coordinate_number, x_cell_method, y_cell_method, v_cell_method, is_h_point, is_q_point, is_u_point, is_v_point, is_layer, is_interface, is_native, needs_remapping, needs_interpolating, xyave_axes)</td></tr>
<tr class="memdesc:ab9f767ec24a860cb71cae264560272a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a group of "axes" from list of handles.  <a href="#ab9f767ec24a860cb71cae264560272a8">More...</a><br /></td></tr>
<tr class="separator:ab9f767ec24a860cb71cae264560272a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d062ce991a3bd7250b3224e6508eb5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a36d062ce991a3bd7250b3224e6508eb5">set_diag_mediator_grid</a> (G, diag_cs)</td></tr>
<tr class="separator:a36d062ce991a3bd7250b3224e6508eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98d892c30de2ee865416e519eacfd79"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ab98d892c30de2ee865416e519eacfd79">post_data_0d</a> (diag_field_id, field, diag_cs, is_static)</td></tr>
<tr class="separator:ab98d892c30de2ee865416e519eacfd79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b75b68fa1742ce312c371f4b2c6ac1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ab5b75b68fa1742ce312c371f4b2c6ac1">post_data_1d_k</a> (diag_field_id, field, diag_cs, is_static)</td></tr>
<tr class="separator:ab5b75b68fa1742ce312c371f4b2c6ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b87038d2cfd2f6709ecb9f4481e0e75"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a2b87038d2cfd2f6709ecb9f4481e0e75">post_data_2d</a> (diag_field_id, field, diag_cs, is_static, mask)</td></tr>
<tr class="separator:a2b87038d2cfd2f6709ecb9f4481e0e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633c4a461809f5843ac522616db8f382"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a633c4a461809f5843ac522616db8f382">post_data_2d_low</a> (diag, field, diag_cs, is_static, mask)</td></tr>
<tr class="separator:a633c4a461809f5843ac522616db8f382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70116fa6034dcf977a8bdcb4d81f9207"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a70116fa6034dcf977a8bdcb4d81f9207">post_data_3d</a> (diag_field_id, field, diag_cs, is_static, mask, alt_h)</td></tr>
<tr class="separator:a70116fa6034dcf977a8bdcb4d81f9207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11cae949c3f8cf68d2c70f656aa9c54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ae11cae949c3f8cf68d2c70f656aa9c54">post_data_3d_low</a> (diag, field, diag_cs, is_static, mask)</td></tr>
<tr class="separator:ae11cae949c3f8cf68d2c70f656aa9c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41a1779c5edb50aa7256477cef952ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ab41a1779c5edb50aa7256477cef952ae">post_xy_average</a> (diag_cs, diag, field)</td></tr>
<tr class="memdesc:ab41a1779c5edb50aa7256477cef952ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post the horizontally area-averaged diagnostic.  <a href="#ab41a1779c5edb50aa7256477cef952ae">More...</a><br /></td></tr>
<tr class="separator:ab41a1779c5edb50aa7256477cef952ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91244f765f2964dfb11f8787f65042f1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a91244f765f2964dfb11f8787f65042f1">enable_averaging</a> (time_int_in, time_end_in, diag_cs)</td></tr>
<tr class="separator:a91244f765f2964dfb11f8787f65042f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1761df399ba39742e34ab989469da0f2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a1761df399ba39742e34ab989469da0f2">disable_averaging</a> (diag_cs)</td></tr>
<tr class="separator:a1761df399ba39742e34ab989469da0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be5d1cbc6c6f8f63950ce7d9bc6455a"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a0be5d1cbc6c6f8f63950ce7d9bc6455a">query_averaging_enabled</a> (diag_cs, time_int, time_end)</td></tr>
<tr class="separator:a0be5d1cbc6c6f8f63950ce7d9bc6455a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e845bc64dfd5116f41fe90922b7937"><td class="memItemLeft" align="right" valign="top">type(time_type) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a76e845bc64dfd5116f41fe90922b7937">get_diag_time_end</a> (diag_cs)</td></tr>
<tr class="separator:a76e845bc64dfd5116f41fe90922b7937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa791f75f899ae9b7cd4756165a9c2a1b"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#aa791f75f899ae9b7cd4756165a9c2a1b">register_diag_field</a> (module_name, field_name, axes, init_time, long_name, units, missing_value, range, mask_variant, standard_name, verbose, do_not_log, err_msg, interp_method, tile_count, cmor_field_name, cmor_long_name, cmor_units, cmor_standard_name, cell_methods, x_cell_method, y_cell_method, v_cell_method, conversion, v_extensive)</td></tr>
<tr class="memdesc:aa791f75f899ae9b7cd4756165a9c2a1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the "diag_mediator" handle for a group (native, CMOR, z-coord, ...) of diagnostics derived from one field.  <a href="#aa791f75f899ae9b7cd4756165a9c2a1b">More...</a><br /></td></tr>
<tr class="separator:aa791f75f899ae9b7cd4756165a9c2a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50b35cba800ac5fd8975929fd2b9f4a"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ae50b35cba800ac5fd8975929fd2b9f4a">register_diag_field_expand_cmor</a> (dm_id, module_name, field_name, axes, init_time, long_name, units, missing_value, range, mask_variant, standard_name, verbose, do_not_log, err_msg, interp_method, tile_count, cmor_field_name, cmor_long_name, cmor_units, cmor_standard_name, cell_methods, x_cell_method, y_cell_method, v_cell_method, conversion, v_extensive)</td></tr>
<tr class="memdesc:ae50b35cba800ac5fd8975929fd2b9f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns True if either the native of CMOr version of the diagnostic were registered. Updates 'dm_id' after calling <a class="el" href="namespacemom__diag__mediator.html#aca4a32fea8dade9f51e076a56b9bad2b" title="Returns an FMS id from register_diag_field_fms (the diag_manager routine) after expanding axes (axes-...">register_diag_field_expand_axes()</a> for both native and CMOR variants of the field.  <a href="#ae50b35cba800ac5fd8975929fd2b9f4a">More...</a><br /></td></tr>
<tr class="separator:ae50b35cba800ac5fd8975929fd2b9f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4a32fea8dade9f51e076a56b9bad2b"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#aca4a32fea8dade9f51e076a56b9bad2b">register_diag_field_expand_axes</a> (module_name, field_name, axes, init_time, long_name, units, missing_value, range, mask_variant, standard_name, verbose, do_not_log, err_msg, interp_method, tile_count)</td></tr>
<tr class="memdesc:aca4a32fea8dade9f51e076a56b9bad2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an FMS id from register_diag_field_fms (the diag_manager routine) after expanding axes (axes-group) into handles and conditionally adding an FMS area_id for cell_measures.  <a href="#aca4a32fea8dade9f51e076a56b9bad2b">More...</a><br /></td></tr>
<tr class="separator:aca4a32fea8dade9f51e076a56b9bad2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8415b33a337b1fbc7535688eca85ab37"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a8415b33a337b1fbc7535688eca85ab37">add_diag_to_list</a> (diag_cs, dm_id, fms_id, this_diag, axes, module_name, field_name, msg)</td></tr>
<tr class="memdesc:a8415b33a337b1fbc7535688eca85ab37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a diagnostic type and attached to list.  <a href="#a8415b33a337b1fbc7535688eca85ab37">More...</a><br /></td></tr>
<tr class="separator:a8415b33a337b1fbc7535688eca85ab37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f04c145cb120fc2ab6cbfe9f166392"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ae0f04c145cb120fc2ab6cbfe9f166392">attach_cell_methods</a> (id, axes, ostring, cell_methods, x_cell_method, y_cell_method, v_cell_method, v_extensive)</td></tr>
<tr class="memdesc:ae0f04c145cb120fc2ab6cbfe9f166392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches "cell_methods" attribute to a variable based on defaults for <a class="el" href="structmom__diag__mediator_1_1axes__grp.html" title="A group of 1D axes that comprise a 1D/2D/3D mesh. ">axes_grp</a> or optional arguments.  <a href="#ae0f04c145cb120fc2ab6cbfe9f166392">More...</a><br /></td></tr>
<tr class="separator:ae0f04c145cb120fc2ab6cbfe9f166392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb4254e1cfbbcfc43028f14915173f80"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#afb4254e1cfbbcfc43028f14915173f80">register_scalar_field</a> (module_name, field_name, init_time, diag_cs, long_name, units, missing_value, range, standard_name, do_not_log, err_msg, interp_method, cmor_field_name, cmor_long_name, cmor_units, cmor_standard_name)</td></tr>
<tr class="separator:afb4254e1cfbbcfc43028f14915173f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe591ed2565e9f026c5be055bc2fc0b7"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#abe591ed2565e9f026c5be055bc2fc0b7">register_static_field</a> (module_name, field_name, axes, long_name, units, missing_value, range, mask_variant, standard_name, do_not_log, interp_method, tile_count, cmor_field_name, cmor_long_name, cmor_units, cmor_standard_name, area)</td></tr>
<tr class="memdesc:abe591ed2565e9f026c5be055bc2fc0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a static diagnostic, returning an integer handle.  <a href="#abe591ed2565e9f026c5be055bc2fc0b7">More...</a><br /></td></tr>
<tr class="separator:abe591ed2565e9f026c5be055bc2fc0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae002ca447acba252bf7bdc042e75a01e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ae002ca447acba252bf7bdc042e75a01e">describe_option</a> (opt_name, value, diag_CS)</td></tr>
<tr class="separator:ae002ca447acba252bf7bdc042e75a01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21267e25d12fa3e5d2540d2a299d2d2c"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a21267e25d12fa3e5d2540d2a299d2d2c">ocean_register_diag</a> (var_desc, G, diag_CS, day)</td></tr>
<tr class="memdesc:a21267e25d12fa3e5d2540d2a299d2d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a diagnostic using the information encapsulated in the vardesc type argument and returns an integer handle to this diagostic. That integer handle is negative if the diagnostic is unused.  <a href="#a21267e25d12fa3e5d2540d2a299d2d2c">More...</a><br /></td></tr>
<tr class="separator:a21267e25d12fa3e5d2540d2a299d2d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ac8a662308a9e766249fdf29956560"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ae8ac8a662308a9e766249fdf29956560">diag_mediator_infrastructure_init</a> (err_msg)</td></tr>
<tr class="separator:ae8ac8a662308a9e766249fdf29956560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03785b401557ffdf08cd45b735e4486f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a03785b401557ffdf08cd45b735e4486f">diag_mediator_init</a> (G, nz, param_file, diag_cs, doc_file_dir)</td></tr>
<tr class="memdesc:a03785b401557ffdf08cd45b735e4486f"><td class="mdescLeft">&#160;</td><td class="mdescRight">diag_mediator_init initializes the MOM diag_mediator and opens the available diagnostics file, if appropriate.  <a href="#a03785b401557ffdf08cd45b735e4486f">More...</a><br /></td></tr>
<tr class="separator:a03785b401557ffdf08cd45b735e4486f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe52776bc4a161c4912ce1987acaf1c1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#abe52776bc4a161c4912ce1987acaf1c1">diag_set_state_ptrs</a> (h, T, S, eqn_of_state, diag_cs)</td></tr>
<tr class="separator:abe52776bc4a161c4912ce1987acaf1c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ce5a74c7e725cfaa01e7abd5dbdb97d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a8ce5a74c7e725cfaa01e7abd5dbdb97d">diag_update_remap_grids</a> (diag_cs, alt_h)</td></tr>
<tr class="memdesc:a8ce5a74c7e725cfaa01e7abd5dbdb97d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build/update vertical grids for diagnostic remapping.  <a href="#a8ce5a74c7e725cfaa01e7abd5dbdb97d">More...</a><br /></td></tr>
<tr class="separator:a8ce5a74c7e725cfaa01e7abd5dbdb97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea7bb1f198219e21cfedb7ead367df1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#acea7bb1f198219e21cfedb7ead367df1">diag_masks_set</a> (G, nz, missing_value, diag_cs)</td></tr>
<tr class="memdesc:acea7bb1f198219e21cfedb7ead367df1"><td class="mdescLeft">&#160;</td><td class="mdescRight">diag_masks_set sets up the 2d and 3d masks for diagnostics  <a href="#acea7bb1f198219e21cfedb7ead367df1">More...</a><br /></td></tr>
<tr class="separator:acea7bb1f198219e21cfedb7ead367df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b7493efa5caee06547dafdba29361b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#ab6b7493efa5caee06547dafdba29361b">diag_mediator_close_registration</a> (diag_CS)</td></tr>
<tr class="separator:ab6b7493efa5caee06547dafdba29361b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780f8870b442c730208d66d1ff0b4ac0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a780f8870b442c730208d66d1ff0b4ac0">diag_mediator_end</a> (time, diag_CS, end_diag_manager)</td></tr>
<tr class="separator:a780f8870b442c730208d66d1ff0b4ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d9bb70db16b1113304936c82d40e82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=15) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a82d9bb70db16b1113304936c82d40e82">i2s</a> (a, n_in)</td></tr>
<tr class="separator:a82d9bb70db16b1113304936c82d40e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a085f313357879a914af6450f2ab8ec79"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a085f313357879a914af6450f2ab8ec79">set_diag_mask</a> (diag, diag_cs, axes)</td></tr>
<tr class="memdesc:a085f313357879a914af6450f2ab8ec79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associates the mask pointers within diag with the appropriate mask based on the axes group.  <a href="#a085f313357879a914af6450f2ab8ec79">More...</a><br /></td></tr>
<tr class="separator:a085f313357879a914af6450f2ab8ec79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7442639213320f7429e2288a79fda2"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a3f7442639213320f7429e2288a79fda2">get_new_diag_id</a> (diag_cs)</td></tr>
<tr class="memdesc:a3f7442639213320f7429e2288a79fda2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a new diagnostic id, it may be necessary to expand the diagnostics array.  <a href="#a3f7442639213320f7429e2288a79fda2">More...</a><br /></td></tr>
<tr class="separator:a3f7442639213320f7429e2288a79fda2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883862f004e30bbc5211f38635511ba0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a883862f004e30bbc5211f38635511ba0">initialize_diag_type</a> (diag)</td></tr>
<tr class="memdesc:a883862f004e30bbc5211f38635511ba0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a <a class="el" href="structmom__diag__mediator_1_1diag__type.html" title="This type is used to represent a diagnostic at the diag_mediator level. There can be both &#39;primary&#39; a...">diag_type</a> (used after allocating new memory)  <a href="#a883862f004e30bbc5211f38635511ba0">More...</a><br /></td></tr>
<tr class="separator:a883862f004e30bbc5211f38635511ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0bed2113a0c268eafd1bafbb48bd4f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a1b0bed2113a0c268eafd1bafbb48bd4f">alloc_diag_with_id</a> (diag_id, diag_cs, diag)</td></tr>
<tr class="separator:a1b0bed2113a0c268eafd1bafbb48bd4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65fe8d329cf5dbfd08c98874a7a64407"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a65fe8d329cf5dbfd08c98874a7a64407">log_available_diag</a> (used, module_name, field_name, cell_methods_string, comment, diag_CS, long_name, units, standard_name)</td></tr>
<tr class="memdesc:a65fe8d329cf5dbfd08c98874a7a64407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a diagnostic to the available diagnostics file.  <a href="#a65fe8d329cf5dbfd08c98874a7a64407">More...</a><br /></td></tr>
<tr class="separator:a65fe8d329cf5dbfd08c98874a7a64407"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a882fc994662be43d067bb1f59a2662bb"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a882fc994662be43d067bb1f59a2662bb">id_clock_diag_mediator</a></td></tr>
<tr class="separator:a882fc994662be43d067bb1f59a2662bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a8e75119f340f174cfef580ded1dd79"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#a8a8e75119f340f174cfef580ded1dd79">id_clock_diag_remap</a></td></tr>
<tr class="separator:a8a8e75119f340f174cfef580ded1dd79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affaf7f9c1f9fc0c35f4a41c9b30b04e6"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemom__diag__mediator.html#affaf7f9c1f9fc0c35f4a41c9b30b04e6">id_clock_diag_grid_updates</a></td></tr>
<tr class="separator:affaf7f9c1f9fc0c35f4a41c9b30b04e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8415b33a337b1fbc7535688eca85ab37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8415b33a337b1fbc7535688eca85ab37">&#9670;&nbsp;</a></span>add_diag_to_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::add_diag_to_list </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), pointer&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>dm_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>fms_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), pointer&#160;</td>
          <td class="paramname"><em>this_diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a diagnostic type and attached to list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">diag_cs</td><td>Diagnostics mediator control structure</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dm_id</td><td>The diag_mediator ID for this diagnostic group</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fms_id</td><td>The FMS diag_manager ID for this diagnostic</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">this_diag</td><td>This diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Container w/ up to 3 integer handles that indicates axes for this field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">module_name</td><td>Name of this module, usually "ocean_model" or "ice_shelf_model"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Message for errors </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01371">1371</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l02211">alloc_diag_with_id()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l02165">get_new_diag_id()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l02113">set_diag_mask()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">register_diag_field_expand_cmor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),        <span class="keywordtype">pointer</span>       :: diag_cs<span class="comment"> !&lt; Diagnostics mediator control structure</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordtype">integer</span>,                <span class="keywordtype">intent(inout)</span> :: dm_id<span class="comment"> !&lt; The diag_mediator ID for this diagnostic group</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordtype">integer</span>,                <span class="keywordtype">intent(in)</span>    :: fms_id<span class="comment"> !&lt; The FMS diag_manager ID for this diagnostic</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordtype">type</span>(diag_type),        <span class="keywordtype">pointer</span>       :: this_diag<span class="comment"> !&lt; This diagnostic</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span>    :: axes<span class="comment"> !&lt; Container w/ up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordtype">character(len=*)</span>,       <span class="keywordtype">intent(in)</span>    :: module_name<span class="comment"> !&lt; Name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="keywordtype">character(len=*)</span>,       <span class="keywordtype">intent(in)</span>    :: field_name<span class="comment"> !&lt; Name of diagnostic</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordtype">character(len=*)</span>,       <span class="keywordtype">intent(in)</span>    :: msg<span class="comment"> !&lt; Message for errors</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">! If the diagnostic is needed obtain a diag_mediator ID (if needed)</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (dm_id == -1) dm_id = get_new_diag_id(diag_cs)</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">! Create a new diag_type to store links in</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keyword">call </span>alloc_diag_with_id(dm_id, diag_cs, this_diag)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keyword">call </span>assert(<span class="keyword">associated</span>(this_diag), trim(msg)//<span class="stringliteral">&#39;: diag_type allocation failed&#39;</span>)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="comment">! Record FMS id, masks and conversion factor, in diag_type</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  this_diag%fms_diag_id = fms_id</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  this_diag%debug_str = trim(module_name)//<span class="stringliteral">&quot;-&quot;</span>//trim(field_name)</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keyword">call </span>set_diag_mask(this_diag, diag_cs, axes)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  this_diag%axes =&gt; axes</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a8415b33a337b1fbc7535688eca85ab37_cgraph.svg" width="100%" height="476"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a8415b33a337b1fbc7535688eca85ab37_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a1b0bed2113a0c268eafd1bafbb48bd4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b0bed2113a0c268eafd1bafbb48bd4f">&#9670;&nbsp;</a></span>alloc_diag_with_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::alloc_diag_with_id </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diag_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(out), pointer&#160;</td>
          <td class="paramname"><em>diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02211">2211</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01371">add_diag_to_list()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l01486">register_scalar_field()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01591">register_static_field()</a>.</p>
<div class="fragment"><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: diag_id</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(out)</span> :: diag</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">! Arguments:</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="comment">!  (in)      diag_id  - new id for the diag.</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="comment">!  (inout)   diag_cs  - structure used to regulate diagnostic output</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="comment">!  (inout)   diag     - structure representing a diagnostic</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: tmp</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="keywordflow">if</span> (.not. diag_cs%diags(diag_id)%in_use) <span class="keywordflow">then</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    diag =&gt; diag_cs%diags(diag_id)</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keyword">allocate</span>(diag)</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    tmp =&gt; diag_cs%diags(diag_id)%next</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    diag_cs%diags(diag_id)%next =&gt; diag</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    diag%next =&gt; tmp</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  diag%in_use = .true.</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a1b0bed2113a0c268eafd1bafbb48bd4f_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae0f04c145cb120fc2ab6cbfe9f166392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f04c145cb120fc2ab6cbfe9f166392">&#9670;&nbsp;</a></span>attach_cell_methods()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::attach_cell_methods </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out)&#160;</td>
          <td class="paramname"><em>ostring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cell_methods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>x_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>y_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>v_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>v_extensive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attaches "cell_methods" attribute to a variable based on defaults for <a class="el" href="structmom__diag__mediator_1_1axes__grp.html" title="A group of 1D axes that comprise a 1D/2D/3D mesh. ">axes_grp</a> or optional arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>Handle to diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Container w/ up to 3 integer handles that indicates axes for this field</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ostring</td><td>The cell_methods strings that would appear in the file</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_methods</td><td>String to append as cell_methods attribute. Use '' to have no attribute. If present, this overrides the default constructed from the default for each individual axis direction.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_cell_method</td><td>Specifies the cell method for the x-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y_cell_method</td><td>Specifies the cell method for the y-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_cell_method</td><td>Specifies the cell method for the vertical direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_extensive</td><td>True for vertically extensive fields (vertically integrated). Default/absent for intensive. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01396">1396</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">register_diag_field_expand_cmor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="keywordtype">integer</span>,                    <span class="keywordtype">intent(in)</span>  :: id<span class="comment"> !&lt; Handle to diagnostic</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keywordtype">type</span>(axes_grp),             <span class="keywordtype">intent(in)</span>  :: axes<span class="comment"> !&lt; Container w/ up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordtype">character(len=*)</span>,           <span class="keywordtype">intent(out)</span> :: ostring<span class="comment"> !&lt; The cell_methods strings that would appear in the file</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: cell_methods<span class="comment"> !&lt; String to append as cell_methods attribute. Use &#39;&#39; to have no attribute.</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">                                                         !! If present, this overrides the default constructed from the default for</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">                                                         !! each individual axis direction.</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: x_cell_method<span class="comment"> !&lt; Specifies the cell method for the x-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: y_cell_method<span class="comment"> !&lt; Specifies the cell method for the y-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: v_cell_method<span class="comment"> !&lt; Specifies the cell method for the vertical direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: v_extensive<span class="comment"> !&lt; True for vertically extensive fields (vertically integrated). Default/absent for intensive.</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordtype">character(len=9)</span> :: axis_name</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  ostring = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(cell_methods)) <span class="keywordflow">then</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(x_cell_method) .or. <span class="keyword">present</span>(y_cell_method) .or. <span class="keyword">present</span>(v_cell_method) &amp;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        .or. <span class="keyword">present</span>(v_extensive)) <span class="keywordflow">then</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;attach_cell_methods: &quot;</span> // &amp;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;           <span class="stringliteral">&#39;Individual direction cell method was specified along with a &quot;cell_methods&quot; string.&#39;</span>)</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">if</span> (len(trim(cell_methods))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(cell_methods))</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      ostring = trim(cell_methods)</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(x_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">if</span> (len(trim(x_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(1), axis_name)</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(x_cell_method))</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(x_cell_method)</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="keywordflow">if</span> (len(trim(axes%x_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(1), axis_name)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%x_cell_method))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%x_cell_method)</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(y_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">if</span> (len(trim(y_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(2), axis_name)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(y_cell_method))</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(y_cell_method)</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="keywordflow">if</span> (len(trim(axes%y_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(2), axis_name)</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%y_cell_method))</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%y_cell_method)</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(v_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(v_extensive)) <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;attach_cell_methods: &quot;</span> // &amp;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;           <span class="stringliteral">&#39;Vertical cell method was specified along with the vertically extensive flag.&#39;</span>)</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keywordflow">if</span> (len(trim(v_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="keywordflow">if</span> (axes%rank==1) <span class="keywordflow">then</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          <span class="keyword">call </span>get_diag_axis_name(axes%handles(1), axis_name)</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">elseif</span> (axes%rank==3) <span class="keywordflow">then</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          <span class="keyword">call </span>get_diag_axis_name(axes%handles(3), axis_name)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(v_cell_method))</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(v_cell_method)</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">elseif</span> (<span class="keyword">present</span>(v_extensive)) <span class="keywordflow">then</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <span class="keywordflow">if</span> (axes%rank==1) <span class="keywordflow">then</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(1), axis_name)</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">elseif</span> (axes%rank==3) <span class="keywordflow">then</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keyword">call </span>get_diag_axis_name(axes%handles(3), axis_name)</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:sum&#39;</span>)</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:sum&#39;</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">if</span> (len(trim(axes%v_cell_method))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">if</span> (axes%rank==1) <span class="keywordflow">then</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;          <span class="keyword">call </span>get_diag_axis_name(axes%handles(1), axis_name)</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">elseif</span> (axes%rank==3) <span class="keywordflow">then</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          <span class="keyword">call </span>get_diag_axis_name(axes%handles(3), axis_name)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keyword">call </span>diag_field_add_attribute(id, <span class="stringliteral">&#39;cell_methods&#39;</span>, trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%v_cell_method))</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        ostring = trim(adjustl(ostring))//<span class="stringliteral">&#39; &#39;</span>//trim(axis_name)//<span class="stringliteral">&#39;:&#39;</span>//trim(axes%v_cell_method)</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  ostring = adjustl(ostring)</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae0f04c145cb120fc2ab6cbfe9f166392_cgraph.svg" width="536" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae0f04c145cb120fc2ab6cbfe9f166392_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ab9f767ec24a860cb71cae264560272a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9f767ec24a860cb71cae264560272a8">&#9670;&nbsp;</a></span>define_axes_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::define_axes_group </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>handles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(out)&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>vertical_coordinate_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>x_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>y_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>v_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_h_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_q_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_u_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_v_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_native</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>needs_remapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>needs_interpolating</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), optional, target&#160;</td>
          <td class="paramname"><em>xyave_axes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines a group of "axes" from list of handles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">handles</td><td>A list of 1D axis handles</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">axes</td><td>The group of 1D axes</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of layers in this diagnostic grid</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vertical_coordinate_number</td><td>Index number for vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_cell_method</td><td>A x-direction cell method used to construct the "cell_methods" attribute in CF convention</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y_cell_method</td><td>A y-direction cell method used to construct the "cell_methods" attribute in CF convention</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_cell_method</td><td>A vertical direction cell method used to construct the "cell_methods" attribute in CF convention</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_h_point</td><td>If true, indicates this axes group for h-point located fields</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_q_point</td><td>If true, indicates this axes group for q-point located fields</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_u_point</td><td>If true, indicates this axes group for u-point located fields</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_v_point</td><td>If true, indicates this axes group for v-point located fields</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_layer</td><td>If true, indicates that this axes group is for a layer vertically-located field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_interface</td><td>If true, indicates that this axes group is for an interface vertically-located field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_native</td><td>If true, indicates that this axes group is for a native model grid. False for any other grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">needs_remapping</td><td>If true, indicates that this axes group is for a intensive layer-located field that must be remapped to these axes. Used for rank&gt;2.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">needs_interpolating</td><td>If true, indicates that this axes group is for a sampled interface-located field that must be interpolated to these axes. Used for rank&gt;2.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">xyave_axes</td><td>The corresponding axes group for horizontally area-average diagnostics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00434">434</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l02092">i2s()</a>, and <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l00213">set_axes_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>,    <span class="keywordtype">intent(in)</span>  :: diag_cs<span class="comment"> !&lt; Diagnostics control structure</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>,      <span class="keywordtype">intent(in)</span>  :: handles<span class="comment"> !&lt; A list of 1D axis handles</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordtype">type</span>(axes_grp),             <span class="keywordtype">intent(out)</span> :: axes<span class="comment">    !&lt; The group of 1D axes</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: nz<span class="comment">      !&lt; Number of layers in this diagnostic grid</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: vertical_coordinate_number<span class="comment"> !&lt; Index number for vertical coordinate</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: x_cell_method<span class="comment"> !&lt; A x-direction cell method used to construct the &quot;cell_methods&quot; attribute in CF convention</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: y_cell_method<span class="comment"> !&lt; A y-direction cell method used to construct the &quot;cell_methods&quot; attribute in CF convention</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: v_cell_method<span class="comment"> !&lt; A vertical direction cell method used to construct the &quot;cell_methods&quot; attribute in CF convention</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_h_point<span class="comment"> !&lt; If true, indicates this axes group for h-point located fields</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_q_point<span class="comment"> !&lt; If true, indicates this axes group for q-point located fields</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_u_point<span class="comment"> !&lt; If true, indicates this axes group for u-point located fields</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_v_point<span class="comment"> !&lt; If true, indicates this axes group for v-point located fields</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_layer<span class="comment"> !&lt; If true, indicates that this axes group is for a layer vertically-located field.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_interface<span class="comment"> !&lt; If true, indicates that this axes group is for an interface vertically-located field.</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: is_native<span class="comment"> !&lt; If true, indicates that this axes group is for a native model grid. False for any other grid.</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: needs_remapping<span class="comment"> !&lt; If true, indicates that this axes group is for a intensive layer-located field</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">                                                             !! that must be remapped to these axes. Used for rank&gt;2.</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: needs_interpolating<span class="comment"> !&lt; If true, indicates that this axes group is for a sampled interface-located field</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">                                                                 !! that must be interpolated to these axes. Used for rank&gt;2.</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordtype">type</span>(axes_grp),   <span class="keywordtype">optional</span>, <span class="keywordtype">target</span>      :: xyave_axes<span class="comment"> !&lt; The corresponding axes group for horizontally area-average diagnostics</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordtype">integer</span> :: n</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  n = <span class="keyword">size</span>(handles)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (n&lt;1 .or. n&gt;3) <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;define_axes_group: wrong size for list of handles!&quot;</span>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keyword">allocate</span>( axes%handles(n) )</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  axes%id = i2s(handles, n) <span class="comment">! Identifying string</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  axes%rank = n</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  axes%handles(:) = handles(:)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  axes%diag_cs =&gt; diag_cs <span class="comment">! A [circular] link back to the diag_cs structure</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(x_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span> (axes%rank&lt;2) <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&#39;define_axes_group: &#39;</span> // &amp;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                           <span class="stringliteral">&#39;Can not set x_cell_method for rank&lt;2.&#39;</span>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    axes%x_cell_method = trim(x_cell_method)</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    axes%x_cell_method = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(y_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (axes%rank&lt;2) <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&#39;define_axes_group: &#39;</span> // &amp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                           <span class="stringliteral">&#39;Can not set y_cell_method for rank&lt;2.&#39;</span>)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    axes%y_cell_method = trim(y_cell_method)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    axes%y_cell_method = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(v_cell_method)) <span class="keywordflow">then</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> (axes%rank/=1 .and. axes%rank/=3) <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&#39;define_axes_group: &#39;</span> // &amp;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                           <span class="stringliteral">&#39;Can not set v_cell_method for rank&lt;&gt;1 or 3.&#39;</span>)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    axes%v_cell_method = trim(v_cell_method)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    axes%v_cell_method = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(nz)) axes%nz = nz</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(vertical_coordinate_number)) axes%vertical_coordinate_number = vertical_coordinate_number</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_h_point)) axes%is_h_point = is_h_point</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_q_point)) axes%is_q_point = is_q_point</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_u_point)) axes%is_u_point = is_u_point</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_v_point)) axes%is_v_point = is_v_point</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_layer)) axes%is_layer = is_layer</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_interface)) axes%is_interface = is_interface</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_native)) axes%is_native = is_native</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(needs_remapping)) axes%needs_remapping = needs_remapping</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(needs_interpolating)) axes%needs_interpolating = needs_interpolating</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(xyave_axes)) axes%xyave_axes =&gt; xyave_axes</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab9f767ec24a860cb71cae264560272a8_cgraph.svg" width="559" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab9f767ec24a860cb71cae264560272a8_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae002ca447acba252bf7bdc042e75a01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae002ca447acba252bf7bdc042e75a01e">&#9670;&nbsp;</a></span>describe_option()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::describe_option </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>opt_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_CS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01695">1695</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l02237">log_available_diag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: opt_name, value</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordtype">character(len=240)</span> :: mesg</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordtype">integer</span> :: len_ind</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  len_ind = len_trim(<span class="keywordtype">value</span>)  <span class="comment">! Add error handling for long values?</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  mesg = <span class="stringliteral">&quot;    ! &quot;</span>//trim(opt_name)//<span class="stringliteral">&quot;: &quot;</span>//trim(<span class="keywordtype">value</span>)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keyword">write</span>(diag_cs%doc_unit, <span class="stringliteral">&#39;(a)&#39;</span>) trim(mesg)</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae002ca447acba252bf7bdc042e75a01e_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="acea7bb1f198219e21cfedb7ead367df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea7bb1f198219e21cfedb7ead367df1">&#9670;&nbsp;</a></span>diag_masks_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_masks_set </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(in), target&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), pointer&#160;</td>
          <td class="paramname"><em>diag_cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>diag_masks_set sets up the 2d and 3d masks for diagnostics </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean grid type.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>The number of layers in the model's native grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">missing_value</td><td>A value to use for masked points.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">diag_cs</td><td>A pointer to a type with many variables used for diagnostics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02002">2002</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM_8F90_source.html#l01480">mom::initialize_mom()</a>.</p>
<div class="fragment"><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: g<span class="comment">  !&lt; The ocean grid type.</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordtype">integer</span>,                       <span class="keywordtype">intent(in)</span> :: nz<span class="comment"> !&lt; The number of layers in the model&#39;s native grid.</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordtype">real</span>,                          <span class="keywordtype">intent(in)</span> :: missing_value<span class="comment"> !&lt; A value to use for masked points.</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),               <span class="keywordtype">pointer</span>    :: diag_cs<span class="comment"> !&lt; A pointer to a type with many variables</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">                                                  !! used for diagnostics</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordtype">integer</span> :: k</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  diag_cs%mask2dT =&gt; g%mask2dT</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  diag_cs%mask2dBu=&gt; g%mask2dBu</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  diag_cs%mask2dCu=&gt; g%mask2dCu</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  diag_cs%mask2dCv=&gt; g%mask2dCv</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dTL(g%isd:g%ied,g%jsd:g%jed,1:nz))</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dBL(g%IsdB:g%IedB,g%JsdB:g%JedB,1:nz))</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dCuL(g%IsdB:g%IedB,g%jsd:g%jed,1:nz))</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dCvL(g%isd:g%ied,g%JsdB:g%JedB,1:nz))</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <span class="keywordflow">do</span> k=1,nz</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    diag_cs%mask3dTL(:,:,k)  = diag_cs%mask2dT (:,:)</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    diag_cs%mask3dBL(:,:,k) = diag_cs%mask2dBu(:,:)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    diag_cs%mask3dCuL(:,:,k) = diag_cs%mask2dCu(:,:)</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    diag_cs%mask3dCvL(:,:,k) = diag_cs%mask2dCv(:,:)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dTi(g%isd:g%ied,g%jsd:g%jed,1:nz+1))</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dBi(g%IsdB:g%IedB,g%JsdB:g%JedB,1:nz+1))</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dCui(g%IsdB:g%IedB,g%jsd:g%jed,1:nz+1))</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="keyword">allocate</span>(diag_cs%mask3dCvi(g%isd:g%ied,g%JsdB:g%JedB,1:nz+1))</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">do</span> k=1,nz+1</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    diag_cs%mask3dTi(:,:,k)  = diag_cs%mask2dT (:,:)</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    diag_cs%mask3dBi(:,:,k) = diag_cs%mask2dBu(:,:)</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    diag_cs%mask3dCui(:,:,k) = diag_cs%mask2dCu(:,:)</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    diag_cs%mask3dCvi(:,:,k) = diag_cs%mask2dCv(:,:)</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">!  diag_cs%missing_value = missing_value</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_acea7bb1f198219e21cfedb7ead367df1_icgraph.svg" width="483" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab6b7493efa5caee06547dafdba29361b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6b7493efa5caee06547dafdba29361b">&#9670;&nbsp;</a></span>diag_mediator_close_registration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_mediator_close_registration </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_CS</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02040">2040</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, and <a class="el" href="ocean__model__MOM_8F90_source.html#l00203">ocean_model_mod::ocean_model_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="keywordflow">if</span> (diag_cs%doc_unit &gt; -1) <span class="keywordflow">then</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keyword">close</span>(diag_cs%doc_unit) ; diag_cs%doc_unit = -2</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keyword">call </span>diag_remap_diag_registration_closed(diag_cs%diag_remap_cs(i))</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab6b7493efa5caee06547dafdba29361b_icgraph.svg" width="380" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a780f8870b442c730208d66d1ff0b4ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780f8870b442c730208d66d1ff0b4ac0">&#9670;&nbsp;</a></span>diag_mediator_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_mediator_end </td>
          <td>(</td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>end_diag_manager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">end_diag_manager</td><td>If true, call diag_manager_end() </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02055">2055</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, and <a class="el" href="ocean__model__MOM_8F90_source.html#l00659">ocean_model_mod::ocean_model_end()</a>.</p>
<div class="fragment"><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="keywordtype">type</span>(time_type),   <span class="keywordtype">intent(in)</span>  :: time</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>  :: end_diag_manager<span class="comment"> !&lt; If true, call diag_manager_end()</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  <span class="keywordflow">if</span> (diag_cs%doc_unit &gt; -1) <span class="keywordflow">then</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="keyword">close</span>(diag_cs%doc_unit) ; diag_cs%doc_unit = -3</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%diags)</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keyword">call </span>diag_remap_end(diag_cs%diag_remap_cs(i))</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dTL)</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dBL)</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dCuL)</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dCvL)</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dTi)</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dBi)</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dCui)</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keyword">deallocate</span>(diag_cs%mask3dCvi)</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">#if defined(DEBUG) || defined(__DO_SAFETY_CHECKS__)</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="preprocessor"></span>  <span class="keyword">deallocate</span>(diag_cs%h_old)</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(end_diag_manager)) <span class="keywordflow">then</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="keywordflow">if</span> (end_diag_manager) <span class="keyword">call </span>diag_manager_end(time)</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a780f8870b442c730208d66d1ff0b4ac0_icgraph.svg" width="380" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae8ac8a662308a9e766249fdf29956560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ac8a662308a9e766249fdf29956560">&#9670;&nbsp;</a></span>diag_mediator_infrastructure_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_mediator_infrastructure_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out), optional&#160;</td>
          <td class="paramname"><em>err_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01814">1814</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">! This subroutine initializes the FMS diag_manager.</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span>   :: err_msg</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keyword">call </span>diag_manager_init(err_msg=err_msg)</div></div><!-- fragment -->
</div>
</div>
<a id="a03785b401557ffdf08cd45b735e4486f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03785b401557ffdf08cd45b735e4486f">&#9670;&nbsp;</a></span>diag_mediator_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_mediator_init </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(inout), target&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>doc_file_dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>diag_mediator_init initializes the MOM diag_mediator and opens the available diagnostics file, if appropriate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>The ocean grid type.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>The number of layers in the model's native grid.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Parameter file structure</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>A pointer to a type with many variables used for diagnostics</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">doc_file_dir</td><td>A directory in which to create the file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01823">1823</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_grid_updates</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_mediator</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_remap</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l02196">initialize_diag_type()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00049">mom_error_handler::is_root_pe()</a>, and <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">target</span>, <span class="keywordtype">intent(inout)</span> :: g<span class="comment">  !&lt; The ocean grid type.</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordtype">integer</span>,                    <span class="keywordtype">intent(in)</span>    :: nz<span class="comment">    !&lt; The number of layers in the model&#39;s native grid.</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordtype">type</span>(param_file_type),      <span class="keywordtype">intent(in)</span>    :: param_file<span class="comment"> !&lt; Parameter file structure</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),            <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment"> !&lt; A pointer to a type with many variables</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">                                                     !! used for diagnostics</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>    :: doc_file_dir<span class="comment"> !&lt; A directory in which to create the</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">                                                     !! file</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">! This subroutine initializes the diag_mediator and the diag_manager.</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">! The grid type should have its dimensions set by this point, but it</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">! is not necessary that the metrics and axis labels be set up yet.</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="keywordtype">integer</span> :: ios, i, new_unit</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keywordtype">logical</span> :: opened, new_file</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordtype">character(len=8)</span>   :: this_pe</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="keywordtype">character(len=240)</span> :: doc_file, doc_file_dflt, doc_path</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordtype">character(len=240)</span>, <span class="keywordtype">allocatable</span> :: diag_coords(:)</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">! This include declares and sets the variable &quot;version&quot;.</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="preprocessor">#include &quot;version_variable.h&quot;</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">character(len=40)</span>  :: mod  = <span class="stringliteral">&quot;MOM_diag_mediator&quot;</span> <span class="comment">! This module&#39;s name.</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  id_clock_diag_mediator = cpu_clock_id(<span class="stringliteral">&#39;(Ocean diagnostics framework)&#39;</span>, grain=clock_module)</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  id_clock_diag_remap = cpu_clock_id(<span class="stringliteral">&#39;(Ocean diagnostics remapping)&#39;</span>, grain=clock_routine)</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  id_clock_diag_grid_updates = cpu_clock_id(<span class="stringliteral">&#39;(Ocean diagnostics grid updates)&#39;</span>, grain=clock_routine)</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <span class="comment">! Allocate and initialize list of all diagnostics (and variants)</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keyword">allocate</span>(diag_cs%diags(diag_alloc_chunk_size))</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  diag_cs%next_free_diag_id = 1</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="keywordflow">do</span> i=1, diag_alloc_chunk_size</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keyword">call </span>initialize_diag_type(diag_cs%diags(i))</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="comment">! Read all relevant parameters and write them to the model log.</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="keyword">call </span>log_version(param_file, mod, version, <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="keyword">call </span>get_param(param_file, mod, <span class="stringliteral">&#39;NUM_DIAG_COORDS&#39;</span>, diag_cs%num_diag_coords, &amp;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                 <span class="stringliteral">&#39;The number of diagnostic vertical coordinates to use.\n&#39;</span>//&amp;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                 <span class="stringliteral">&#39;For each coordinate, an entry in DIAG_COORDS must be provided.&#39;</span>, &amp;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                 default=1)</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">if</span> (diag_cs%num_diag_coords&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keyword">allocate</span>(diag_coords(diag_cs%num_diag_coords))</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">if</span> (diag_cs%num_diag_coords==1) <span class="keywordflow">then</span> <span class="comment">! The default is to provide just one instance of Z*</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keyword">call </span>get_param(param_file, mod, <span class="stringliteral">&#39;DIAG_COORDS&#39;</span>, diag_coords, &amp;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                 <span class="stringliteral">&#39;A list of string tuples associating diag_table modules to\n&#39;</span>//&amp;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                 <span class="stringliteral">&#39;a coordinate definition used for diagnostics. Each string\n&#39;</span>//&amp;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                 <span class="stringliteral">&#39;is of the form &quot;MODULE_SUFFIX PARAMETER_SUFFIX COORDINATE_NAME&quot;.&#39;</span>, &amp;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                 default=<span class="stringliteral">&#39;z Z ZSTAR&#39;</span>)</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">else</span> <span class="comment">! If using more than 1 diagnostic coordinate, all must be explicitly defined</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keyword">call </span>get_param(param_file, mod, <span class="stringliteral">&#39;DIAG_COORDS&#39;</span>, diag_coords, &amp;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                 <span class="stringliteral">&#39;A list of string tuples associating diag_table modules to\n&#39;</span>//&amp;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                 <span class="stringliteral">&#39;a coordinate definition used for diagnostics. Each string\n&#39;</span>//&amp;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                 <span class="stringliteral">&#39;is of the form &quot;MODULE_SUFFIX,PARAMETER_SUFFIX,COORDINATE_NAME&quot;.&#39;</span>, &amp;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                 fail_if_missing=.true.)</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keyword">allocate</span>(diag_cs%diag_remap_cs(diag_cs%num_diag_coords))</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="comment">! Initialize each diagnostic vertical coordinate</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keyword">call </span>diag_remap_init(diag_cs%diag_remap_cs(i), diag_coords(i))</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keyword">deallocate</span>(diag_coords)</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keyword">call </span>get_param(param_file, mod, <span class="stringliteral">&#39;DIAG_MISVAL&#39;</span>, diag_cs%missing_value, &amp;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                 <span class="stringliteral">&#39;Set the default missing value to use for diagnostics.&#39;</span>, &amp;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                 default=-1.e34)</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="comment">! Keep pointers grid, h, T, S needed diagnostic remapping</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  diag_cs%G =&gt; g</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  diag_cs%h =&gt; null()</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  diag_cs%T =&gt; null()</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  diag_cs%S =&gt; null()</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  diag_cs%eqn_of_state =&gt; null()</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#if defined(DEBUG) || defined(__DO_SAFETY_CHECKS__)</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="preprocessor"></span>  <span class="keyword">allocate</span>(diag_cs%h_old(g%isd:g%ied,g%jsd:g%jed,nz))</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  diag_cs%h_old(:,:,:) = 0.0</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  diag_cs%is = g%isc - (g%isd-1) ; diag_cs%ie = g%iec - (g%isd-1)</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  diag_cs%js = g%jsc - (g%jsd-1) ; diag_cs%je = g%jec - (g%jsd-1)</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  diag_cs%isd = g%isd ; diag_cs%ied = g%ied</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  diag_cs%jsd = g%jsd ; diag_cs%jed = g%jed</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="keywordflow">if</span> (is_root_pe() .and. (diag_cs%doc_unit &lt; 0)) <span class="keywordflow">then</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keyword">write</span>(this_pe,<span class="stringliteral">&#39;(i6.6)&#39;</span>) pe_here()</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    doc_file_dflt = <span class="stringliteral">&quot;available_diags.&quot;</span>//this_pe</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keyword">call </span>get_param(param_file, mod, <span class="stringliteral">&quot;AVAILABLE_DIAGS_FILE&quot;</span>, doc_file, &amp;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                 <span class="stringliteral">&quot;A file into which to write a list of all available \n&quot;</span>//&amp;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                 <span class="stringliteral">&quot;ocean diagnostics that can be included in a diag_table.&quot;</span>, &amp;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                 default=doc_file_dflt, do_not_log=(diag_cs%doc_unit/=-1))</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">if</span> (len_trim(doc_file) &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      new_file = .true. ; <span class="keywordflow">if</span> (diag_cs%doc_unit /= -1) new_file = .false.</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">! Find an unused unit number.</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordflow">do</span> new_unit=512,42,-1</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keyword">inquire</span>( new_unit, opened=opened)</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keywordflow">if</span> (.not.opened) <span class="keywordflow">exit</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keywordflow">if</span> (opened) <span class="keyword">call </span>mom_error(fatal, &amp;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;          <span class="stringliteral">&quot;diag_mediator_init failed to find an unused unit number.&quot;</span>)</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      doc_path = doc_file</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(doc_file_dir)) <span class="keywordflow">then</span> ; <span class="keywordflow">if</span> (len_trim(doc_file_dir) &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        doc_path = trim(slasher(doc_file_dir))//trim(doc_file)</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="keywordflow">      endif</span> ;<span class="keywordflow"> endif</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      diag_cs%doc_unit = new_unit</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordflow">if</span> (new_file) <span class="keywordflow">then</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keyword">open</span>(diag_cs%doc_unit, file=trim(doc_path), access=<span class="stringliteral">&#39;SEQUENTIAL&#39;</span>, form=<span class="stringliteral">&#39;FORMATTED&#39;</span>, &amp;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;             action=<span class="stringliteral">&#39;WRITE&#39;</span>, status=<span class="stringliteral">&#39;REPLACE&#39;</span>, iostat=ios)</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keywordflow">else</span> <span class="comment">! This file is being reopened, and should be appended.</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="keyword">open</span>(diag_cs%doc_unit, file=trim(doc_path), access=<span class="stringliteral">&#39;SEQUENTIAL&#39;</span>, form=<span class="stringliteral">&#39;FORMATTED&#39;</span>, &amp;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;             action=<span class="stringliteral">&#39;WRITE&#39;</span>, status=<span class="stringliteral">&#39;OLD&#39;</span>, position=<span class="stringliteral">&#39;APPEND&#39;</span>, iostat=ios)</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keyword">inquire</span>(diag_cs%doc_unit, opened=opened)</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keywordflow">if</span> ((.not.opened) .or. (ios /= 0)) <span class="keywordflow">then</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;Failed to open available diags file &quot;</span>//trim(doc_path)//<span class="stringliteral">&quot;.&quot;</span>)</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a03785b401557ffdf08cd45b735e4486f_cgraph.svg" width="542" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2795a8a8618f945a9a0830f461d3e42d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2795a8a8618f945a9a0830f461d3e42d">&#9670;&nbsp;</a></span>diag_register_area_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_register_area_ids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>id_area_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>id_area_q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attaches the id of cell areas to axes groups for use with cell_measures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id_area_t</td><td>Diag_mediator id for area of h-cells</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id_area_q</td><td>Diag_mediator id for area of q-cells </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00389">389</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),   <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment">   !&lt; Diagnostics control structure</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>    :: id_area_t<span class="comment"> !&lt; Diag_mediator id for area of h-cells</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>    :: id_area_q<span class="comment"> !&lt; Diag_mediator id for area of q-cells</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordtype">integer</span> :: fms_id, i</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(id_area_t)) <span class="keywordflow">then</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    fms_id = diag_cs%diags(id_area_t)%fms_diag_id</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    diag_cs%axesT1%id_area = fms_id</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    diag_cs%axesTi%id_area = fms_id</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    diag_cs%axesTL%id_area = fms_id</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      diag_cs%remap_axesTL(i)%id_area = fms_id</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">! Note to AJA: why am I not doing TZi too?</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(id_area_q)) <span class="keywordflow">then</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    fms_id = diag_cs%diags(id_area_q)%fms_diag_id</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    diag_cs%axesB1%id_area = fms_id</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    diag_cs%axesBi%id_area = fms_id</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    diag_cs%axesBL%id_area = fms_id</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      diag_cs%remap_axesBL(i)%id_area = fms_id</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordflow">  endif</span></div></div><!-- fragment -->
</div>
</div>
<a id="a7238cbbe68b1e044c0bc081534159801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7238cbbe68b1e044c0bc081534159801">&#9670;&nbsp;</a></span>diag_register_volume_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_register_volume_ids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>id_vol_t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attaches the id of cell volumes to axes groups for use with cell_measures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id_vol_t</td><td>Diag_manager id for volume of h-cells </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00417">417</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),   <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment">   !&lt; Diagnostics control structure</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span>    :: id_vol_t<span class="comment"> !&lt; Diag_manager id for volume of h-cells</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">integer</span> :: fms_id</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(id_vol_t)) <span class="keywordflow">then</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    fms_id = diag_cs%diags(id_vol_t)%fms_diag_id</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;diag_register_volume_ids: not implemented yet!&quot;</span>)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordflow">  endif</span></div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a7238cbbe68b1e044c0bc081534159801_cgraph.svg" width="559" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abe52776bc4a161c4912ce1987acaf1c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe52776bc4a161c4912ce1987acaf1c1">&#9670;&nbsp;</a></span>diag_set_state_ptrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_set_state_ptrs </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(eos_type), intent(in), pointer&#160;</td>
          <td class="paramname"><em>eqn_of_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eqn_of_state</td><td>Equation of state structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01946">1946</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: h, t, s</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordtype">type</span>(eos_type),  <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(in)</span>       :: eqn_of_state<span class="comment"> !&lt; Equation of state structure</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="comment">!  (inout) diag_cs - diag mediator control structure</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="comment">!  (in) h - a pointer to model thickness</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="comment">!  (in) T - a pointer to model temperature</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="comment">!  (in) S - a pointer to model salinity</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="comment">! Keep pointers to h, T, S needed for the diagnostic remapping</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  diag_cs%h =&gt; h</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  diag_cs%T =&gt; t</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  diag_cs%S =&gt; s</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  diag_cs%eqn_of_state =&gt; eqn_of_state</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8ce5a74c7e725cfaa01e7abd5dbdb97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ce5a74c7e725cfaa01e7abd5dbdb97d">&#9670;&nbsp;</a></span>diag_update_remap_grids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::diag_update_remap_grids </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>alt_h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build/update vertical grids for diagnostic remapping. </p>
<dl class="section note"><dt>Note</dt><dd>The target grids need to be updated whenever sea surface height changes.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alt_h</td><td>Used if remapped grids should be something other than the current thicknesses </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01968">1968</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_grid_updates</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__bulk__mixed__layer_8F90_source.html#l00227">mom_bulk_mixed_layer::bulkmixedlayer()</a>, <a class="el" href="MOM__mixed__layer__restrat_8F90_source.html#l00538">mom_mixed_layer_restrat::mixedlayer_restrat_bml()</a>, <a class="el" href="MOM__mixed__layer__restrat_8F90_source.html#l00113">mom_mixed_layer_restrat::mixedlayer_restrat_general()</a>, <a class="el" href="MOM__dynamics__split__RK2_8F90_source.html#l00205">mom_dynamics_split_rk2::step_mom_dyn_split_rk2()</a>, and <a class="el" href="MOM__thickness__diffuse_8F90_source.html#l00076">mom_thickness_diffuse::thickness_diffuse()</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),        <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment">      !&lt; Diagnostics control structure</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">target</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in   )</span> :: alt_h(:,:,:)<span class="comment"> !&lt; Used if remapped grids should be</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">                                                        !! something other than the current</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">                                                        !! thicknesses</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">pointer</span> :: h_diag</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(alt_h)) <span class="keywordflow">then</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    h_diag =&gt; alt_h</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    h_diag =&gt; diag_cs%h</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_grid_updates&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_grid_updates)</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keyword">call </span>diag_remap_update(diag_cs%diag_remap_cs(i), &amp;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                           diag_cs%G, h_diag, diag_cs%T, diag_cs%S, &amp;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                           diag_cs%eqn_of_state)</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="preprocessor">#if defined(DEBUG) || defined(__DO_SAFETY_CHECKS__)</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="preprocessor"></span>  <span class="comment">! Keep a copy of H - used to check whether grids are up-to-date</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="comment">! when doing remapping.</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  diag_cs%h_old(:,:,:) = diag_cs%h(:,:,:)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_grid_updates&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_grid_updates)</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a8ce5a74c7e725cfaa01e7abd5dbdb97d_icgraph.svg" width="100%" height="535"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a1761df399ba39742e34ab989469da0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1761df399ba39742e34ab989469da0f2">&#9670;&nbsp;</a></span>disable_averaging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::disable_averaging </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01001">1001</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, and <a class="el" href="MOM__ice__shelf_8F90_source.html#l00346">mom_ice_shelf::shelf_calc_flux()</a>.</p>
<div class="fragment"><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">! Argument:</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">! diag - structure used to regulate diagnostic output</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  diag_cs%time_int = 0.0</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  diag_cs%ave_enabled = .false.</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a1761df399ba39742e34ab989469da0f2_icgraph.svg" width="487" height="82"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a91244f765f2964dfb11f8787f65042f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91244f765f2964dfb11f8787f65042f1">&#9670;&nbsp;</a></span>enable_averaging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::enable_averaging </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>time_int_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>time_end_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00980">980</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__barotropic_8F90_source.html#l00413">mom_barotropic::btstep()</a>, <a class="el" href="MOM__legacy__barotropic_8F90_source.html#l00393">mom_legacy_barotropic::legacy_btstep()</a>, <a class="el" href="MOM__driver_8F90_source.html#l00001">mom_main()</a>, and <a class="el" href="MOM__ice__shelf_8F90_source.html#l00346">mom_ice_shelf::shelf_calc_flux()</a>.</p>
<div class="fragment"><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: time_int_in</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">type</span>(time_type), <span class="keywordtype">intent(in)</span> :: time_end_in</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">! This subroutine enables the accumulation of time averages over the</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">! specified time interval.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">!  (in)      time_int_in - time interval in s over which any</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">!                          values that are offered are valid.</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">!  (in)      time_end_in - end time in s of the valid interval</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">!  (inout)   diag        - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">!  if (num_file==0) return</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  diag_cs%time_int = time_int_in</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  diag_cs%time_end = time_end_in</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  diag_cs%ave_enabled = .true.</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a91244f765f2964dfb11f8787f65042f1_icgraph.svg" width="500" height="222"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a76e845bc64dfd5116f41fe90922b7937"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76e845bc64dfd5116f41fe90922b7937">&#9670;&nbsp;</a></span>get_diag_time_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(time_type) function, public mom_diag_mediator::get_diag_time_end </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_cs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01030">1030</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(in)</span>  :: diag_cs</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordtype">type</span>(time_type) :: get_diag_time_end</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">! Argument:</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">! (in) diag - structure used to regulate diagnostic output</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">!   This function returns the valid end time for diagnostics that are handled</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">! outside of the MOM6 infrastructure, such as via the generic tracer code.</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  get_diag_time_end = diag_cs%time_end</div></div><!-- fragment -->
</div>
</div>
<a id="a3f7442639213320f7429e2288a79fda2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f7442639213320f7429e2288a79fda2">&#9670;&nbsp;</a></span>get_new_diag_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function mom_diag_mediator::get_new_diag_id </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a new diagnostic id, it may be necessary to expand the diagnostics array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02165">2165</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l02196">initialize_diag_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01371">add_diag_to_list()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l01486">register_scalar_field()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01591">register_static_field()</a>.</p>
<div class="fragment"><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment"> !&lt; Diagnostics control structure</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: tmp</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordtype">integer</span> :: i</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">if</span> (diag_cs%next_free_diag_id &gt; <span class="keyword">size</span>(diag_cs%diags)) <span class="keywordflow">then</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keyword">call </span>assert(diag_cs%next_free_diag_id - <span class="keyword">size</span>(diag_cs%diags) == 1, &amp;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                <span class="stringliteral">&#39;get_new_diag_id: inconsistent diag id&#39;</span>)</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">! Increase the size of diag_cs%diags and copy data over.</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="comment">! Do not use move_alloc() because it is not supported by Fortran 90</span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keyword">allocate</span>(tmp(<span class="keyword">size</span>(diag_cs%diags)))</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    tmp(:) = diag_cs%diags(:)</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keyword">deallocate</span>(diag_cs%diags)</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keyword">allocate</span>(diag_cs%diags(<span class="keyword">size</span>(tmp) + diag_alloc_chunk_size))</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    diag_cs%diags(1:<span class="keyword">size</span>(tmp)) = tmp(:)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keyword">deallocate</span>(tmp)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">! Initialize new part of the diag array.</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keywordflow">do</span> i=diag_cs%next_free_diag_id, <span class="keyword">size</span>(diag_cs%diags)</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      <span class="keyword">call </span>initialize_diag_type(diag_cs%diags(i))</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  get_new_diag_id = diag_cs%next_free_diag_id</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  diag_cs%next_free_diag_id = diag_cs%next_free_diag_id + 1</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a3f7442639213320f7429e2288a79fda2_cgraph.svg" width="100%" height="388"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a3f7442639213320f7429e2288a79fda2_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a82d9bb70db16b1113304936c82d40e82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d9bb70db16b1113304936c82d40e82">&#9670;&nbsp;</a></span>i2s()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=15) function mom_diag_mediator::i2s </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>n_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02092">2092</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l00434">define_axes_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">!   &quot;Convert the first n elements of an integer array to a string.&quot;</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: a</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>    , <span class="keywordtype">intent(in)</span> :: n_in</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordtype">character(len=15)</span> :: i2s</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordtype">character(len=15)</span> :: i2s_temp</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keywordtype">integer</span> :: i,n</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    n=<span class="keyword">size</span>(a)</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(n_in)) n = n_in</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    i2s = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="keywordflow">do</span> i=1,n</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;       <span class="keyword">write</span> (i2s_temp, <span class="stringliteral">&#39;(I4.4)&#39;</span>) a(i)</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;       i2s = trim(i2s) //<span class="stringliteral">&#39;_&#39;</span>// trim(i2s_temp)</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    i2s = adjustl(i2s)</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a82d9bb70db16b1113304936c82d40e82_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a883862f004e30bbc5211f38635511ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883862f004e30bbc5211f38635511ba0">&#9670;&nbsp;</a></span>initialize_diag_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::initialize_diag_type </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a <a class="el" href="structmom__diag__mediator_1_1diag__type.html" title="This type is used to represent a diagnostic at the diag_mediator level. There can be both &#39;primary&#39; a...">diag_type</a> (used after allocating new memory) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag</td><td><a class="el" href="structmom__diag__mediator_1_1diag__type.html" title="This type is used to represent a diagnostic at the diag_mediator level. There can be both &#39;primary&#39; a...">diag_type</a> to be initialized </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02196">2196</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01823">diag_mediator_init()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l02165">get_new_diag_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">intent(inout)</span> :: diag<span class="comment"> !&lt; diag_type to be initialized</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  diag%in_use = .false.</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  diag%fms_diag_id = -1</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  diag%axes =&gt; null()</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  diag%mask2d =&gt; null()</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  diag%mask3d =&gt; null()</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  diag%next =&gt; null()</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  diag%conversion_factor = 0.</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a883862f004e30bbc5211f38635511ba0_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a65fe8d329cf5dbfd08c98874a7a64407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65fe8d329cf5dbfd08c98874a7a64407">&#9670;&nbsp;</a></span>log_available_diag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::log_available_diag </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>cell_methods_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log a diagnostic to the available diagnostics file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">used</td><td>Whether this diagnostic was in the diag_table or not</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">module_name</td><td>Name of the diagnostic module</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of this diagnostic field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_methods_string</td><td>The spatial component of the CF cell_methods attribute</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comment</td><td>A comment to append after [Used|Unused]</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag_cs</td><td>The diagnotics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">long_name</td><td>CF long name of diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">units</td><td>Units for diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">standard_name</td><td>CF standardized name of diagnostic </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02237">2237</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l01695">describe_option()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">register_diag_field_expand_cmor()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l01486">register_scalar_field()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01591">register_static_field()</a>.</p>
<div class="fragment"><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">intent(in)</span> :: used<span class="comment"> !&lt; Whether this diagnostic was in the diag_table or not</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name<span class="comment"> !&lt; Name of the diagnostic module</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name<span class="comment"> !&lt; Name of this diagnostic field</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: cell_methods_string<span class="comment"> !&lt; The spatial component of the CF cell_methods attribute</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: comment<span class="comment"> !&lt; A comment to append after [Used|Unused]</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),  <span class="keywordtype">intent(in)</span> :: diag_cs<span class="comment">  !&lt; The diagnotics control structure</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name<span class="comment"> !&lt; CF long name of diagnostic</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: units<span class="comment"> !&lt; Units for diagnostic</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: standard_name<span class="comment"> !&lt; CF standardized name of diagnostic</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="keywordtype">character(len=240)</span> :: mesg</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordflow">if</span> (used) <span class="keywordflow">then</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    mesg = <span class="stringliteral">&#39;&quot;&#39;</span>//trim(module_name)//<span class="stringliteral">&#39;&quot;, &quot;&#39;</span>//trim(field_name)//<span class="stringliteral">&#39;&quot;  [Used]&#39;</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    mesg = <span class="stringliteral">&#39;&quot;&#39;</span>//trim(module_name)//<span class="stringliteral">&#39;&quot;, &quot;&#39;</span>//trim(field_name)//<span class="stringliteral">&#39;&quot;  [Unused]&#39;</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="keywordflow">if</span> (len(trim((comment)))&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keyword">write</span>(diag_cs%doc_unit, <span class="stringliteral">&#39;(a,x,&quot;(&quot;,a,&quot;)&quot;)&#39;</span>) trim(mesg),trim(comment)</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="keyword">write</span>(diag_cs%doc_unit, <span class="stringliteral">&#39;(a)&#39;</span>) trim(mesg)</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(long_name)) <span class="keyword">call </span>describe_option(<span class="stringliteral">&quot;long_name&quot;</span>, long_name, diag_cs)</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(units)) <span class="keyword">call </span>describe_option(<span class="stringliteral">&quot;units&quot;</span>, units, diag_cs)</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(standard_name)) &amp;</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keyword">call </span>describe_option(<span class="stringliteral">&quot;standard_name&quot;</span>, standard_name, diag_cs)</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="keywordflow">if</span> (len(trim((cell_methods_string)))&gt;0) &amp;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keyword">call </span>describe_option(<span class="stringliteral">&quot;cell_methods&quot;</span>, trim(cell_methods_string), diag_cs)</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a65fe8d329cf5dbfd08c98874a7a64407_cgraph.svg" width="352" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a65fe8d329cf5dbfd08c98874a7a64407_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a21267e25d12fa3e5d2540d2a299d2d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21267e25d12fa3e5d2540d2a299d2d2c">&#9670;&nbsp;</a></span>ocean_register_diag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mom_diag_mediator::ocean_register_diag </td>
          <td>(</td>
          <td class="paramtype">type(vardesc), intent(in)&#160;</td>
          <td class="paramname"><em>var_desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(ocean_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>day</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a diagnostic using the information encapsulated in the vardesc type argument and returns an integer handle to this diagostic. That integer handle is negative if the diagnostic is unused. </p>
<dl class="section return"><dt>Returns</dt><dd>An integer handle to this diagnostic.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">var_desc</td><td>The vardesc type describing the diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>The ocean's grid type</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag_cs</td><td>The diagnotic control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">day</td><td>The current model time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01711">1711</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>, <a class="el" href="MOM__io_8F90_source.html#l00664">mom_io::query_vardesc()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01048">register_diag_field()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__to__Z_8F90_source.html#l01289">mom_diag_to_z::ocean_register_diag_with_z()</a>.</p>
<div class="fragment"><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordtype">integer</span> :: ocean_register_diag<span class="comment">  !&lt; An integer handle to this diagnostic.</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keywordtype">type</span>(vardesc),         <span class="keywordtype">intent(in)</span> :: var_desc<span class="comment"> !&lt; The vardesc type describing the diagnostic</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(in)</span> :: g<span class="comment">        !&lt; The ocean&#39;s grid type</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: diag_cs<span class="comment">  !&lt; The diagnotic control structure</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordtype">type</span>(time_type),       <span class="keywordtype">intent(in)</span> :: day<span class="comment">      !&lt; The current model time</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="keywordtype">character(len=64)</span> :: var_name         <span class="comment">! A variable&#39;s name.</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordtype">character(len=48)</span> :: units            <span class="comment">! A variable&#39;s units.</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordtype">character(len=240)</span> :: longname        <span class="comment">! A variable&#39;s longname.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keywordtype">character(len=8)</span> :: hor_grid, z_grid  <span class="comment">! Variable grid info.</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">pointer</span> :: axes</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keyword">call </span>query_vardesc(var_desc, units=units, longname=longname, hor_grid=hor_grid, &amp;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                     z_grid=z_grid, caller=<span class="stringliteral">&quot;ocean_register_diag&quot;</span>)</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="comment">! Use the hor_grid and z_grid components of vardesc to determine the</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">! desired axes to register the diagnostic field for.</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordflow">select case</span> (z_grid)</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&quot;L&quot;</span>)</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keywordflow">select case</span> (hor_grid)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;q&quot;</span>)</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;          axes =&gt; diag_cs%axesBL</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;h&quot;</span>)</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          axes =&gt; diag_cs%axesTL</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;u&quot;</span>)</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          axes =&gt; diag_cs%axesCuL</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;v&quot;</span>)</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          axes =&gt; diag_cs%axesCvL</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Bu&quot;</span>)</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          axes =&gt; diag_cs%axesBL</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;T&quot;</span>)</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;          axes =&gt; diag_cs%axesTL</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cu&quot;</span>)</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          axes =&gt; diag_cs%axesCuL</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cv&quot;</span>)</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;          axes =&gt; diag_cs%axesCvL</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;z&quot;</span>)</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          axes =&gt; diag_cs%axeszL</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="keywordflow">        case default</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;          <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;ocean_register_diag: &quot;</span> // &amp;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;              <span class="stringliteral">&quot;unknown hor_grid component &quot;</span>//trim(hor_grid))</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="keywordflow">      end select</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&quot;i&quot;</span>)</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">select case</span> (hor_grid)</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;q&quot;</span>)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;          axes =&gt; diag_cs%axesBi</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;h&quot;</span>)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;          axes =&gt; diag_cs%axesTi</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;u&quot;</span>)</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          axes =&gt; diag_cs%axesCui</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;v&quot;</span>)</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;          axes =&gt; diag_cs%axesCvi</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Bu&quot;</span>)</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;          axes =&gt; diag_cs%axesBi</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;T&quot;</span>)</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;          axes =&gt; diag_cs%axesTi</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cu&quot;</span>)</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;          axes =&gt; diag_cs%axesCui</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cv&quot;</span>)</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          axes =&gt; diag_cs%axesCvi</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;z&quot;</span>)</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          axes =&gt; diag_cs%axeszi</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="keywordflow">        case default</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;          <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;ocean_register_diag: &quot;</span> // &amp;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            <span class="stringliteral">&quot;unknown hor_grid component &quot;</span>//trim(hor_grid))</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="keywordflow">      end select</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">case</span> (<span class="stringliteral">&quot;1&quot;</span>)</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="keywordflow">select case</span> (hor_grid)</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;q&quot;</span>)</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;          axes =&gt; diag_cs%axesB1</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;h&quot;</span>)</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;          axes =&gt; diag_cs%axesT1</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;u&quot;</span>)</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;          axes =&gt; diag_cs%axesCu1</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;v&quot;</span>)</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;          axes =&gt; diag_cs%axesCv1</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Bu&quot;</span>)</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;          axes =&gt; diag_cs%axesB1</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;T&quot;</span>)</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;          axes =&gt; diag_cs%axesT1</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cu&quot;</span>)</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          axes =&gt; diag_cs%axesCu1</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">case</span> (<span class="stringliteral">&quot;Cv&quot;</span>)</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          axes =&gt; diag_cs%axesCv1</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="keywordflow">        case default</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;          <span class="keyword">call </span>mom_error(fatal, <span class="stringliteral">&quot;ocean_register_diag: &quot;</span> // &amp;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <span class="stringliteral">&quot;unknown hor_grid component &quot;</span>//trim(hor_grid))</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="keywordflow">      end select</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="keywordflow">    case default</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="keyword">call </span>mom_error(fatal,&amp;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="stringliteral">&quot;ocean_register_diag: unknown z_grid component &quot;</span>//trim(z_grid))</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="keywordflow">  end select</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  ocean_register_diag = register_diag_field(<span class="stringliteral">&quot;ocean_model&quot;</span>, trim(var_name), &amp;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          axes, day, trim(longname), trim(units),  missing_value = -1.0e+34)</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a21267e25d12fa3e5d2540d2a299d2d2c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a21267e25d12fa3e5d2540d2a299d2d2c_icgraph.svg" width="363" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab98d892c30de2ee865416e519eacfd79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab98d892c30de2ee865416e519eacfd79">&#9670;&nbsp;</a></span>post_data_0d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_data_0d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diag_field_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00516">516</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_mediator</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">integer</span>,           <span class="keywordtype">intent(in)</span> :: diag_field_id</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordtype">real</span>,              <span class="keywordtype">intent(in)</span> :: field</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">!  (in) diag_field_id  - the id for an output variable returned by a</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">!                            previous call to register_diag_field.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">!  (in)      field     - 0-d array being offered for output or averaging.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">!  (inout)   diag_cs - structure used to regulate diagnostic output.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">!  (in,opt)  is_static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">!  (in,opt)  mask      - If present, use this real array as the data mask.</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">logical</span> :: used, is_stat</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null()</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_mediator)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  is_stat = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_static)) is_stat = is_static</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">! Iterate over list of diag &#39;variants&#39;, e.g. CMOR aliases, call send_data</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">! for each one.</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keyword">call </span>assert(diag_field_id &lt; diag_cs%next_free_diag_id, &amp;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;              <span class="stringliteral">&#39;post_data_0d: Unregistered diagnostic id&#39;</span>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  diag =&gt; diag_cs%diags(diag_field_id)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (<span class="keyword">associated</span>(diag))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (is_stat) <span class="keywordflow">then</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      used = send_data(diag%fms_diag_id, field)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">elseif</span> (diag_cs%ave_enabled) <span class="keywordflow">then</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      used = send_data(diag%fms_diag_id, field, diag_cs%time_end)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    diag =&gt; diag%next</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_mediator)</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab98d892c30de2ee865416e519eacfd79_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ab5b75b68fa1742ce312c371f4b2c6ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b75b68fa1742ce312c371f4b2c6ac1">&#9670;&nbsp;</a></span>post_data_1d_k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::post_data_1d_k </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diag_field_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00553">553</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_mediator</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diapyc__energy__req_8F90_source.html#l00143">mom_diapyc_energy_req::diapyc_energy_req_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">integer</span>,           <span class="keywordtype">intent(in)</span> :: diag_field_id</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">real</span>,              <span class="keywordtype">intent(in)</span> :: field(:)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">!  (in) diag_field_id - id for an output variable returned by a</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">!                       previous call to register_diag_field.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">!  (in)         field - 3-d array being offered for output or averaging</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">!  (inout)    diag_cs - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">!  (in)        static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordtype">logical</span> :: used  <span class="comment">! The return value of send_data is not used for anything.</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordtype">logical</span> :: is_stat</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">integer</span> :: isv, iev, jsv, jev</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null()</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_mediator)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  is_stat = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_static)) is_stat = is_static</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">! Iterate over list of diag &#39;variants&#39;, e.g. CMOR aliases.</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">call </span>assert(diag_field_id &lt; diag_cs%next_free_diag_id, &amp;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;              <span class="stringliteral">&#39;post_data_1d_k: Unregistered diagnostic id&#39;</span>)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  diag =&gt; diag_cs%diags(diag_field_id)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (<span class="keyword">associated</span>(diag))</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (is_stat) <span class="keywordflow">then</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      used = send_data(diag%fms_diag_id, field)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">elseif</span> (diag_cs%ave_enabled) <span class="keywordflow">then</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      used = send_data(diag%fms_diag_id, field, diag_cs%time_end, weight=diag_cs%time_int)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    diag =&gt; diag%next</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_mediator)</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab5b75b68fa1742ce312c371f4b2c6ac1_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab5b75b68fa1742ce312c371f4b2c6ac1_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a2b87038d2cfd2f6709ecb9f4481e0e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b87038d2cfd2f6709ecb9f4481e0e75">&#9670;&nbsp;</a></span>post_data_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_data_2d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diag_field_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00590">590</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_mediator</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00621">post_data_2d_low()</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">integer</span>,           <span class="keywordtype">intent(in)</span> :: diag_field_id</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">real</span>,              <span class="keywordtype">intent(in)</span> :: field(:,:)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask(:,:)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">!  (in) diag_field_id  - id for an output variable returned by a</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">!                        previous call to register_diag_field.</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">!  (in)         field  - 2-d array being offered for output or averaging.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">!  (inout)    diag_cs  - structure used to regulate diagnostic output.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">!  (in,opt)  is_static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">!  (in,opt)   mask     - If present, use this real array as the data mask.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null()</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_mediator)</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">! Iterate over list of diag &#39;variants&#39; (e.g. CMOR aliases) and post each.</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keyword">call </span>assert(diag_field_id &lt; diag_cs%next_free_diag_id, &amp;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;              <span class="stringliteral">&#39;post_data_2d: Unregistered diagnostic id&#39;</span>)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  diag =&gt; diag_cs%diags(diag_field_id)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (<span class="keyword">associated</span>(diag))</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     <span class="keyword">call </span>post_data_2d_low(diag, field, diag_cs, is_static, mask)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    diag =&gt; diag%next</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_mediator)</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a2b87038d2cfd2f6709ecb9f4481e0e75_cgraph.svg" width="100%" height="383"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a633c4a461809f5843ac522616db8f382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633c4a461809f5843ac522616db8f382">&#9670;&nbsp;</a></span>post_data_2d_low()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_data_2d_low </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00621">621</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, and <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l00590">post_data_2d()</a>.</p>
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">type</span>(diag_type),   <span class="keywordtype">intent(in)</span> :: diag</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">target</span>,   <span class="keywordtype">intent(in)</span> :: field(:,:)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask(:,:)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">!  (in) diag          - structure representing the diagnostic to post</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">!  (in)        field  - 2-d array being offered for output or averaging</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">!  (inout) diag_cs    - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">!  (in,opt) is_static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">!  (in,opt)  mask     - If present, use this real array as the data mask.</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">pointer</span> :: locfield =&gt; null()</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordtype">logical</span> :: used, is_stat</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordtype">integer</span> :: isv, iev, jsv, jev</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  is_stat = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_static)) is_stat = is_static</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">! Determine the propery array indices, noting that because of the (:,:)</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">! declaration of field, symmetric arrays are using a SW-grid indexing,</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">! but non-symmetric arrays are using a NE-grid indexing.  Send_data</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">! actually only uses the difference between ie and is to determine</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">! the output data size and assumes that halos are symmetric.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  isv = diag_cs%is ; iev = diag_cs%ie ; jsv = diag_cs%js ; jev = diag_cs%je</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ied-diag_cs%isd +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    isv = diag_cs%is ; iev = diag_cs%ie        <span class="comment">! Data domain</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ied-diag_cs%isd +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    isv = diag_cs%is ; iev = diag_cs%ie+1      <span class="comment">! Symmetric data domain</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ie-diag_cs%is +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    isv = 1 ; iev = diag_cs%ie + 1-diag_cs%is  <span class="comment">! Computational domain</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ie-diag_cs%is +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    isv = 1 ; iev = diag_cs%ie + 2-diag_cs%is  <span class="comment">! Symmetric computational domain</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_2d_low: peculiar size in i-direction&quot;</span>)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">if</span> ( <span class="keyword">size</span>(field,2) == diag_cs%jed-diag_cs%jsd +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    jsv = diag_cs%js ; jev = diag_cs%je        <span class="comment">! Data domain</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,2) == diag_cs%jed-diag_cs%jsd +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    jsv = diag_cs%js ; jev = diag_cs%je+1      <span class="comment">! Symmetric data domain</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,2) == diag_cs%je-diag_cs%js +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    jsv = 1 ; jev = diag_cs%je + 1-diag_cs%js  <span class="comment">! Computational domain</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%je-diag_cs%js +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    jsv = 1 ; jev = diag_cs%je + 2-diag_cs%js  <span class="comment">! Symmetric computational domain</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_2d_low: peculiar size in j-direction&quot;</span>)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (diag%conversion_factor/=0.) <span class="keywordflow">then</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">allocate</span>( locfield( lbound(field,1):ubound(field,1), lbound(field,2):ubound(field,2) ) )</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    locfield(isv:iev,jsv:jev) = field(isv:iev,jsv:jev) * diag%conversion_factor</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    locfield =&gt; field</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordflow">if</span> (is_stat) <span class="keywordflow">then</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keyword">call </span>assert(<span class="keyword">size</span>(locfield) == <span class="keyword">size</span>(mask), &amp;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="stringliteral">&#39;post_data_2d_low is_stat: mask size mismatch: &#39;</span>//diag%debug_str)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      used = send_data(diag%fms_diag_id, locfield, &amp;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                       is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, rmask=mask)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="comment">!elseif(associated(diag%mask2d)) then</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   <span class="comment">!  used = send_data(diag%fms_diag_id, locfield, &amp;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <span class="comment">!                   is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, rmask=diag%mask2d)</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      used = send_data(diag%fms_diag_id, locfield, &amp;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                       is_in=isv, js_in=jsv, ie_in=iev, je_in=jev)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">elseif</span> (diag_cs%ave_enabled) <span class="keywordflow">then</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keyword">call </span>assert(<span class="keyword">size</span>(locfield) == <span class="keyword">size</span>(mask), &amp;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="stringliteral">&#39;post_data_2d_low: mask size mismatch: &#39;</span>//diag%debug_str)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                       is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                       weight=diag_cs%time_int, rmask=mask)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">elseif</span>(<span class="keyword">associated</span>(diag%mask2d)) <span class="keywordflow">then</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                       is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                       weight=diag_cs%time_int, rmask=diag%mask2d)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                       is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                       weight=diag_cs%time_int)</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">if</span> (diag%conversion_factor/=0.) <span class="keyword">deallocate</span>( locfield )</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a633c4a461809f5843ac522616db8f382_cgraph.svg" width="100%" height="361"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a633c4a461809f5843ac522616db8f382_icgraph.svg" width="352" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a70116fa6034dcf977a8bdcb4d81f9207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70116fa6034dcf977a8bdcb4d81f9207">&#9670;&nbsp;</a></span>post_data_3d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_data_3d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>diag_field_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>alt_h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00712">712</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_mediator</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">id_clock_diag_remap</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00835">post_data_3d_low()</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">integer</span>,           <span class="keywordtype">intent(in)</span> :: diag_field_id</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">real</span>,              <span class="keywordtype">intent(in)</span> :: field(:,:,:)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask(:,:,:)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">target</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: alt_h(:,:,:)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">!  (in) diag_field_id - id for an output variable returned by a</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">!                       previous call to register_diag_field.</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">!  (in)         field - 3-d array being offered for output or averaging</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">!  (inout)       diag - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">!  (in)        static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">!  (in,opt)      mask - If present, use this real array as the data mask.</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null()</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordtype">integer</span> :: nz, i, j, k</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span> :: remapped_field</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">logical</span> :: staggered_in_x, staggered_in_y</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">pointer</span> :: h_diag</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(alt_h)) <span class="keywordflow">then</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    h_diag =&gt; alt_h</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    h_diag =&gt; diag_cs%h</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_mediator)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">! Iterate over list of diag &#39;variants&#39;, e.g. CMOR aliases, different vertical</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">! grids, and post each.</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keyword">call </span>assert(diag_field_id &lt; diag_cs%next_free_diag_id, &amp;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;              <span class="stringliteral">&#39;post_data_3d: Unregistered diagnostic id&#39;</span>)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  diag =&gt; diag_cs%diags(diag_field_id)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (<span class="keyword">associated</span>(diag))</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keyword">call </span>assert(<span class="keyword">associated</span>(diag%axes), <span class="stringliteral">&#39;post_data_3d: axes is not associated&#39;</span>)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    staggered_in_x = diag%axes%is_u_point .or. diag%axes%is_q_point</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    staggered_in_y = diag%axes%is_v_point .or. diag%axes%is_q_point</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (diag%v_extensive .and. .not.diag%axes%is_native) <span class="keywordflow">then</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">! The field is vertically integrated and needs to be re-gridded</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_3d: no mask for regridded field.&quot;</span>)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keyword">allocate</span>(remapped_field(<span class="keyword">size</span>(field,1), <span class="keyword">size</span>(field,2), diag%axes%nz))</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keyword">call </span>vertically_reintegrate_diag_field( &amp;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;              diag_cs%diag_remap_cs(diag%axes%vertical_coordinate_number), &amp;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;              diag_cs%G, h_diag, staggered_in_x, staggered_in_y, &amp;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;              diag%mask3d, diag_cs%missing_value, field, remapped_field)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(diag%mask3d)) <span class="keywordflow">then</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">! Since 3d masks do not vary in the vertical, just use as much as is</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">! needed.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static, &amp;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                              mask=diag%mask3d(:,:,:diag%axes%nz))</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keyword">deallocate</span>(remapped_field)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">elseif</span> (diag%axes%needs_remapping) <span class="keywordflow">then</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="comment">! Remap this field to another vertical coordinate.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_3d: no mask for regridded field.&quot;</span>)</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keyword">allocate</span>(remapped_field(<span class="keyword">size</span>(field,1), <span class="keyword">size</span>(field,2), diag%axes%nz))</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keyword">call </span>diag_remap_do_remap(diag_cs%diag_remap_cs( &amp;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;              diag%axes%vertical_coordinate_number), &amp;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;              diag_cs%G, h_diag, staggered_in_x, staggered_in_y, &amp;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;              diag%mask3d, diag_cs%missing_value, field, remapped_field)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(diag%mask3d)) <span class="keywordflow">then</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="comment">! Since 3d masks do not vary in the vertical, just use as much as is</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment">! needed.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static, &amp;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                              mask=diag%mask3d(:,:,:diag%axes%nz))</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keyword">deallocate</span>(remapped_field)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">elseif</span> (diag%axes%needs_interpolating) <span class="keywordflow">then</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="comment">! Interpolate this field to another vertical coordinate.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_3d: no mask for regridded field.&quot;</span>)</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keyword">allocate</span>(remapped_field(<span class="keyword">size</span>(field,1), <span class="keyword">size</span>(field,2), diag%axes%nz+1))</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keyword">call </span>vertically_interpolate_diag_field(diag_cs%diag_remap_cs( &amp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;              diag%axes%vertical_coordinate_number), &amp;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;              diag_cs%G, h_diag, staggered_in_x, staggered_in_y, &amp;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;              diag%mask3d, diag_cs%missing_value, field, remapped_field)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(diag%mask3d)) <span class="keywordflow">then</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="comment">! Since 3d masks do not vary in the vertical, just use as much as is</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">! needed.</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static, &amp;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                              mask=diag%mask3d(:,:,:diag%axes%nz+1))</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keyword">call </span>post_data_3d_low(diag, remapped_field, diag_cs, is_static)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_begin(id_clock_diag_remap)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keyword">deallocate</span>(remapped_field)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">if</span> (id_clock_diag_remap&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_remap)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keyword">call </span>post_data_3d_low(diag, field, diag_cs, is_static, mask)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    diag =&gt; diag%next</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordflow">if</span> (id_clock_diag_mediator&gt;0) <span class="keyword">call </span>cpu_clock_end(id_clock_diag_mediator)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a70116fa6034dcf977a8bdcb4d81f9207_cgraph.svg" width="100%" height="502"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae11cae949c3f8cf68d2c70f656aa9c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae11cae949c3f8cf68d2c70f656aa9c54">&#9670;&nbsp;</a></span>post_data_3d_low()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_data_3d_low </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>is_static</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), optional&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00835">835</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00073">mom_error_handler::mom_error()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00936">post_xy_average()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l00712">post_data_3d()</a>.</p>
<div class="fragment"><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordtype">type</span>(diag_type),   <span class="keywordtype">intent(in)</span> :: diag</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">target</span>,   <span class="keywordtype">intent(in)</span> :: field(:,:,:)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),   <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: is_static</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask(:,:,:)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">!  (in) diag          - the diagnostic to post.</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">!  (in)         field - 3-d array being offered for output or averaging</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">!  (inout)    diag_cs - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">!  (in)        static - If true, this is a static field that is always offered.</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">!  (in,opt)      mask - If present, use this real array as the data mask.</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">pointer</span> :: locfield =&gt; null()</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">logical</span> :: used  <span class="comment">! The return value of send_data is not used for anything.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordtype">logical</span> :: is_stat</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordtype">integer</span> :: isv, iev, jsv, jev</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  is_stat = .false. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(is_static)) is_stat = is_static</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">! Determine the proper array indices, noting that because of the (:,:)</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">! declaration of field, symmetric arrays are using a SW-grid indexing,</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">! but non-symmetric arrays are using a NE-grid indexing.  Send_data</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">! actually only uses the difference between ie and is to determine</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">! the output data size and assumes that halos are symmetric.</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  isv = diag_cs%is ; iev = diag_cs%ie ; jsv = diag_cs%js ; jev = diag_cs%je</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ied-diag_cs%isd +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    isv = diag_cs%is ; iev = diag_cs%ie        <span class="comment">! Data domain</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ied-diag_cs%isd +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    isv = diag_cs%is ; iev = diag_cs%ie+1      <span class="comment">! Symmetric data domain</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ie-diag_cs%is +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    isv = 1 ; iev = diag_cs%ie + 1-diag_cs%is  <span class="comment">! Computational domain</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%ie-diag_cs%is +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    isv = 1 ; iev = diag_cs%ie + 2-diag_cs%is  <span class="comment">! Symmetric computational domain</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_3d_low: peculiar size in i-direction&quot;</span>)</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> ( <span class="keyword">size</span>(field,2) == diag_cs%jed-diag_cs%jsd +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    jsv = diag_cs%js ; jev = diag_cs%je        <span class="comment">! Data domain</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,2) == diag_cs%jed-diag_cs%jsd +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    jsv = diag_cs%js ; jev = diag_cs%je+1      <span class="comment">! Symmetric data domain</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,2) == diag_cs%je-diag_cs%js +1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    jsv = 1 ; jev = diag_cs%je + 1-diag_cs%js  <span class="comment">! Computational domain</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">elseif</span> ( <span class="keyword">size</span>(field,1) == diag_cs%je-diag_cs%js +2 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    jsv = 1 ; jev = diag_cs%je + 2-diag_cs%js  <span class="comment">! Symmetric computational domain</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keyword">call </span>mom_error(fatal,<span class="stringliteral">&quot;post_data_3d_low: peculiar size in j-direction&quot;</span>)</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">if</span> (diag%conversion_factor/=0.) <span class="keywordflow">then</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keyword">allocate</span>( locfield( lbound(field,1):ubound(field,1), lbound(field,2):ubound(field,2), &amp;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                        lbound(field,3):ubound(field,3) ) )</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    locfield(isv:iev,jsv:jev,:) = field(isv:iev,jsv:jev,:) * diag%conversion_factor</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    locfield =&gt; field</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">if</span> (diag%fms_diag_id&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span> (is_stat) <span class="keywordflow">then</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keyword">call </span>assert(<span class="keyword">size</span>(locfield) == <span class="keyword">size</span>(mask), &amp;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="stringliteral">&#39;post_data_3d_low is_stat: mask size mismatch: &#39;</span>//diag%debug_str)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        used = send_data(diag%fms_diag_id, locfield, &amp;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                         is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, rmask=mask)</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;     <span class="comment">!elseif(associated(diag%mask3d)) then</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;     <span class="comment">!  used = send_data(diag_field_id, locfield, &amp;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;     <span class="comment">!                   is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, rmask=diag%mask3d)</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        used = send_data(diag%fms_diag_id, locfield, &amp;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                         is_in=isv, js_in=jsv, ie_in=iev, je_in=jev)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">elseif</span> (diag_cs%ave_enabled) <span class="keywordflow">then</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(mask)) <span class="keywordflow">then</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keyword">call </span>assert(<span class="keyword">size</span>(locfield) == <span class="keyword">size</span>(mask), &amp;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="stringliteral">&#39;post_data_3d_low: mask size mismatch: &#39;</span>//diag%debug_str)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                         is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                         weight=diag_cs%time_int, rmask=mask)</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">elseif</span>(<span class="keyword">associated</span>(diag%mask3d)) <span class="keywordflow">then</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keyword">call </span>assert(<span class="keyword">size</span>(locfield) == <span class="keyword">size</span>(diag%mask3d), &amp;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="stringliteral">&#39;post_data_3d_low: mask3d size mismatch: &#39;</span>//diag%debug_str)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                         is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                         weight=diag_cs%time_int, rmask=diag%mask3d)</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        used = send_data(diag%fms_diag_id, locfield, diag_cs%time_end, &amp;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                         is_in=isv, js_in=jsv, ie_in=iev, je_in=jev, &amp;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                         weight=diag_cs%time_int)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">if</span> (diag%fms_xyave_diag_id&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keyword">call </span>post_xy_average(diag_cs, diag, locfield)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">if</span> (diag%conversion_factor/=0.) <span class="keyword">deallocate</span>( locfield )</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae11cae949c3f8cf68d2c70f656aa9c54_cgraph.svg" width="100%" height="408"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae11cae949c3f8cf68d2c70f656aa9c54_icgraph.svg" width="352" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab41a1779c5edb50aa7256477cef952ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41a1779c5edb50aa7256477cef952ae">&#9670;&nbsp;</a></span>post_xy_average()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::post_xy_average </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post the horizontally area-averaged diagnostic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">diag</td><td>This diagnostic</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field</td><td>Diagnostic field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diag_cs</td><td>Diagnostics mediator control structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00936">936</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, and <a class="el" href="MOM__diag__remap_8F90_source.html#l00517">mom_diag_remap::horizontally_average_diag_field()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l00835">post_data_3d_low()</a>.</p>
<div class="fragment"><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordtype">type</span>(diag_type),   <span class="keywordtype">intent(in)</span> :: diag<span class="comment"> !&lt; This diagnostic</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="keywordtype">real</span>,    <span class="keywordtype">target</span>,   <span class="keywordtype">intent(in)</span> :: field(:,:,:)<span class="comment"> !&lt; Diagnostic field</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),   <span class="keywordtype">intent(in)</span> :: diag_cs<span class="comment"> !&lt; Diagnostics mediator control structure</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">! Local variable</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordtype">real</span>, <span class="keywordtype">dimension(size(field,3))</span> :: averaged_field</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordtype">logical</span> :: staggered_in_x, staggered_in_y, used</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordtype">integer</span> :: nz, remap_nz, coord</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordflow">if</span> (.not. diag_cs%ave_enabled) <span class="keywordflow">then</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">return</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  staggered_in_x = diag%axes%is_u_point .or. diag%axes%is_q_point</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  staggered_in_y = diag%axes%is_v_point .or. diag%axes%is_q_point</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (diag%axes%is_native) <span class="keywordflow">then</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keyword">call </span>horizontally_average_diag_field(diag_cs%G, diag_cs%h, &amp;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                         staggered_in_x, staggered_in_y, &amp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                         diag%axes%is_layer, diag%v_extensive, &amp;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                         diag_cs%missing_value, field, averaged_field)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    nz = <span class="keyword">size</span>(field, 3)</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    coord = diag%axes%vertical_coordinate_number</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    remap_nz = diag_cs%diag_remap_cs(coord)%nz</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keyword">call </span>assert(diag_cs%diag_remap_cs(coord)%initialized, &amp;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <span class="stringliteral">&#39;post_xy_average: remap_cs not initialized.&#39;</span>)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keyword">call </span>assert(implies(diag%axes%is_layer, nz == remap_nz), &amp;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;              <span class="stringliteral">&#39;post_xy_average: layer field dimension mismatch.&#39;</span>)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keyword">call </span>assert(implies(.not. diag%axes%is_layer, nz == remap_nz+1), &amp;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="stringliteral">&#39;post_xy_average: interface field dimension mismatch.&#39;</span>)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keyword">call </span>horizontally_average_diag_field(diag_cs%G, diag_cs%diag_remap_cs(coord)%h, &amp;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                         staggered_in_x, staggered_in_y, &amp;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                                         diag%axes%is_layer, diag%v_extensive, &amp;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                                         diag_cs%missing_value, field, averaged_field)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  used = send_data(diag%fms_xyave_diag_id, averaged_field, diag_cs%time_end, &amp;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                   weight=diag_cs%time_int)</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab41a1779c5edb50aa7256477cef952ae_cgraph.svg" width="100%" height="361"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ab41a1779c5edb50aa7256477cef952ae_icgraph.svg" width="547" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0be5d1cbc6c6f8f63950ce7d9bc6455a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be5d1cbc6c6f8f63950ce7d9bc6455a">&#9670;&nbsp;</a></span>query_averaging_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public mom_diag_mediator::query_averaging_enabled </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out), optional&#160;</td>
          <td class="paramname"><em>time_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(out), optional&#160;</td>
          <td class="paramname"><em>time_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01014">1014</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__lateral__mixing__coeffs_8F90_source.html#l00133">mom_lateral_mixing_coeffs::calc_resoln_function()</a>, <a class="el" href="MOM__lateral__mixing__coeffs_8F90_source.html#l00380">mom_lateral_mixing_coeffs::calc_slope_functions()</a>, <a class="el" href="MOM__lateral__mixing__coeffs_8F90_source.html#l00421">mom_lateral_mixing_coeffs::calc_visbeck_coeffs()</a>, <a class="el" href="MOM__diabatic__driver_8F90_source.html#l00235">mom_diabatic_driver::diabatic()</a>, <a class="el" href="MOM__forcing__type_8F90_source.html#l01848">mom_forcing_type::forcing_diagnostics()</a>, <a class="el" href="MOM__forcing__type_8F90_source.html#l01809">mom_forcing_type::mech_forcing_diags()</a>, and <a class="el" href="MOM__opacity_8F90_source.html#l00122">mom_opacity::set_opacity()</a>.</p>
<div class="fragment"><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),           <span class="keywordtype">intent(in)</span> :: diag_cs</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordtype">real</span>,            <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span> :: time_int</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordtype">type</span>(time_type), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span> :: time_end</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordtype">logical</span> :: query_averaging_enabled</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">!  (in)          diag - structure used to regulate diagnostic output</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">!  (out,opt) time_int - current setting of diag%time_int, in s</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">!  (out,opt) time_end - current setting of diag%time_end</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(time_int)) time_int = diag_cs%time_int</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(time_end)) time_end = diag_cs%time_end</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  query_averaging_enabled = diag_cs%ave_enabled</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a0be5d1cbc6c6f8f63950ce7d9bc6455a_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aa791f75f899ae9b7cd4756165a9c2a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa791f75f899ae9b7cd4756165a9c2a1b">&#9670;&nbsp;</a></span>register_diag_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mom_diag_mediator::register_diag_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>init_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>mask_variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>do_not_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out), optional&#160;</td>
          <td class="paramname"><em>err_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>tile_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cell_methods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>x_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>y_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>v_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>conversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>v_extensive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the "diag_mediator" handle for a group (native, CMOR, z-coord, ...) of diagnostics derived from one field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">module_name</td><td>Name of this module, usually "ocean_model" or "ice_shelf_model"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the diagnostic field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Container w/ up to 3 integer handles that indicates axes for this field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_time</td><td>Time at which a field is first available?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">long_name</td><td>Long name of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">units</td><td>Units of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">standard_name</td><td>Standardized name associated with a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">missing_value</td><td>A value that indicates missing values.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Valid range of a variable (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask_variant</td><td>If true a logical mask must be provided with <a class="el" href="interfacemom__diag__mediator_1_1post__data.html">post_data</a> calls (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>If true, FMS is verbose (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_not_log</td><td>If true, do not log something (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err_msg</td><td>String into which an error message might be placed (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interp_method</td><td>If 'none' indicates the field should not be interpolated as a scalar</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tile_count</td><td>no clue (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_field_name</td><td>CMOR name of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_long_name</td><td>CMOR long name of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_units</td><td>CMOR units of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_standard_name</td><td>CMOR standardized name associated with a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_methods</td><td>String to append as cell_methods attribute. Use '' to have no attribute. If present, this overrides the default constructed from the default for each individual axis direction.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_cell_method</td><td>Specifies the cell method for the x-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y_cell_method</td><td>Specifies the cell method for the y-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_cell_method</td><td>Specifies the cell method for the vertical direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conversion</td><td>A value to multiply data by before writing to file</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_extensive</td><td>True for vertically extensive fields (vertically integrated). Default/absent for intensive. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01048">1048</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">register_diag_field_expand_cmor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__ALE_8F90_source.html#l00261">mom_ale::ale_register_diags()</a>, <a class="el" href="MOM__CoriolisAdv_8F90_source.html#l00875">mom_coriolisadv::coriolisadv_init()</a>, <a class="el" href="MOM__diapyc__energy__req_8F90_source.html#l01297">mom_diapyc_energy_req::diapyc_energy_req_init()</a>, <a class="el" href="MOM__diffConvection_8F90_source.html#l00042">mom_diffconvection::diffconvection_init()</a>, <a class="el" href="MOM__internal__tide__input_8F90_source.html#l00276">mom_int_tide_input::int_tide_input_init()</a>, <a class="el" href="MOM__KPP_8F90_source.html#l00133">mom_kpp::kpp_init()</a>, <a class="el" href="MOM__neutral__diffusion_8F90_source.html#l00119">mom_neutral_diffusion::neutral_diffusion_diag_init()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01711">ocean_register_diag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name<span class="comment"> !&lt; Name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name<span class="comment"> !&lt; Name of the diagnostic field</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: axes<span class="comment"> !&lt; Container w/ up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordtype">type</span>(time_type),  <span class="keywordtype">intent(in)</span> :: init_time<span class="comment"> !&lt; Time at which a field is first available?</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name<span class="comment"> !&lt; Long name of a field.</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: units<span class="comment"> !&lt; Units of a field.</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: standard_name<span class="comment"> !&lt; Standardized name associated with a field</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: missing_value<span class="comment"> !&lt; A value that indicates missing values.</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: range(2)<span class="comment"> !&lt; Valid range of a variable (not used in MOM?)</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask_variant<span class="comment"> !&lt; If true a logical mask must be provided with post_data calls (not used in MOM?)</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: verbose<span class="comment"> !&lt; If true, FMS is verbose (not used in MOM?)</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: do_not_log<span class="comment"> !&lt; If true, do not log something (not used in MOM?)</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span>:: err_msg<span class="comment"> !&lt; String into which an error message might be placed (not used in MOM?)</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: interp_method<span class="comment"> !&lt; If &#39;none&#39; indicates the field should not be interpolated as a scalar</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: tile_count<span class="comment"> !&lt; no clue (not used in MOM?)</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_field_name<span class="comment"> !&lt; CMOR name of a field</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_long_name<span class="comment"> !&lt; CMOR long name of a field</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_units<span class="comment"> !&lt; CMOR units of a field</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_standard_name<span class="comment"> !&lt; CMOR standardized name associated with a field</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cell_methods<span class="comment"> !&lt; String to append as cell_methods attribute. Use &#39;&#39; to have no attribute.</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">                                                         !! If present, this overrides the default constructed from the default for</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">                                                         !! each individual axis direction.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: x_cell_method<span class="comment"> !&lt; Specifies the cell method for the x-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: y_cell_method<span class="comment"> !&lt; Specifies the cell method for the y-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: v_cell_method<span class="comment"> !&lt; Specifies the cell method for the vertical direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: conversion<span class="comment"> !&lt; A value to multiply data by before writing to file</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: v_extensive<span class="comment"> !&lt; True for vertically extensive fields (vertically integrated). Default/absent for intensive.</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordtype">real</span> :: mom_missing_value</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">pointer</span> :: diag_cs</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">pointer</span> :: remap_axes =&gt; null()</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordtype">integer</span> :: dm_id, i</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordtype">character(len=256)</span> :: new_module_name</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordtype">logical</span> :: active</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  mom_missing_value = axes%diag_cs%missing_value</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(missing_value)) mom_missing_value = missing_value</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  diag_cs =&gt; axes%diag_cs</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  dm_id = -1</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">! Register the native diagnostic</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  active = register_diag_field_expand_cmor(dm_id, module_name, field_name, axes, &amp;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;             init_time, long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;             range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;             verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;             interp_method=interp_method, tile_count=tile_count, &amp;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;             cmor_field_name=cmor_field_name, cmor_long_name=cmor_long_name, &amp;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;             cmor_units=cmor_units, cmor_standard_name=cmor_standard_name, &amp;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;             cell_methods=cell_methods, x_cell_method=x_cell_method, &amp;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;             y_cell_method=y_cell_method, v_cell_method=v_cell_method, &amp;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;             conversion=conversion, v_extensive=v_extensive)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">! For each diagnostic coordinate register the diagnostic again under a different module name</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">do</span> i=1,diag_cs%num_diag_coords</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    new_module_name = trim(module_name)//<span class="stringliteral">&#39;_&#39;</span>//trim(diag_cs%diag_remap_cs(i)%diag_module_suffix)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">! Register diagnostics remapped to z vertical coordinate</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (axes%rank == 3) <span class="keywordflow">then</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      remap_axes =&gt; null()</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keywordflow">if</span> ((axes%id .eq. diag_cs%axesTL%id)) <span class="keywordflow">then</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          remap_axes =&gt; diag_cs%remap_axesTL(i)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesBL%id) <span class="keywordflow">then</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          remap_axes =&gt; diag_cs%remap_axesBL(i)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesCuL%id ) <span class="keywordflow">then</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          remap_axes =&gt; diag_cs%remap_axesCuL(i)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesCvL%id) <span class="keywordflow">then</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          remap_axes =&gt; diag_cs%remap_axesCvL(i)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesTi%id) <span class="keywordflow">then</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          remap_axes =&gt; diag_cs%remap_axesTi(i)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesBi%id) <span class="keywordflow">then</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          remap_axes =&gt; diag_cs%remap_axesBi(i)</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesCui%id ) <span class="keywordflow">then</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          remap_axes =&gt; diag_cs%remap_axesCui(i)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keywordflow">elseif</span>(axes%id .eq. diag_cs%axesCvi%id) <span class="keywordflow">then</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;          remap_axes =&gt; diag_cs%remap_axesCvi(i)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="comment">! When the MOM_diag_to_Z module has been obsoleted we can assume remap_axes will</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="comment">! always exist but in the mean-time we have to do this check:</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="comment">! call assert(associated(remap_axes), &#39;register_diag_field: remap_axes not set&#39;)</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">associated</span>(remap_axes)) <span class="keywordflow">then</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">if</span> (remap_axes%needs_remapping .or. remap_axes%needs_interpolating) <span class="keywordflow">then</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          active = register_diag_field_expand_cmor(dm_id, new_module_name, field_name, remap_axes, &amp;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                     init_time, long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                     range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                     verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                     interp_method=interp_method, tile_count=tile_count, &amp;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                     cmor_field_name=cmor_field_name, cmor_long_name=cmor_long_name, &amp;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                     cmor_units=cmor_units, cmor_standard_name=cmor_standard_name, &amp;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                     cell_methods=cell_methods, x_cell_method=x_cell_method, &amp;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                     y_cell_method=y_cell_method, v_cell_method=v_cell_method, &amp;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                     conversion=conversion, v_extensive=v_extensive)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          <span class="keywordflow">if</span> (active) <span class="keywordflow">then</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="keyword">call </span>diag_remap_set_active(diag_cs%diag_remap_cs(i))</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keywordflow">        endif</span> <span class="comment">! remap_axes%needs_remapping</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keywordflow">      endif</span> <span class="comment">! associated(remap_axes)</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordflow">    endif</span> <span class="comment">! axes%rank == 3</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="keywordflow">  enddo</span> <span class="comment">! i</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  register_diag_field = dm_id</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_aa791f75f899ae9b7cd4756165a9c2a1b_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_aa791f75f899ae9b7cd4756165a9c2a1b_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aca4a32fea8dade9f51e076a56b9bad2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4a32fea8dade9f51e076a56b9bad2b">&#9670;&nbsp;</a></span>register_diag_field_expand_axes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function mom_diag_mediator::register_diag_field_expand_axes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>init_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>mask_variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>do_not_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out), optional&#160;</td>
          <td class="paramname"><em>err_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>tile_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns an FMS id from register_diag_field_fms (the diag_manager routine) after expanding axes (axes-group) into handles and conditionally adding an FMS area_id for cell_measures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">module_name</td><td>Name of this module, usually "ocean_model" or "ice_shelf_model"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the diagnostic field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Container w/ up to 3 integer handles that indicates axes for this field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_time</td><td>Time at which a field is first available?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">long_name</td><td>Long name of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">units</td><td>Units of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">standard_name</td><td>Standardized name associated with a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">missing_value</td><td>A value that indicates missing values.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Valid range of a variable (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask_variant</td><td>If true a logical mask must be provided with <a class="el" href="interfacemom__diag__mediator_1_1post__data.html">post_data</a> calls (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>If true, FMS is verbose (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_not_log</td><td>If true, do not log something (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err_msg</td><td>String into which an error message might be placed (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interp_method</td><td>If 'none' indicates the field should not be interpolated as a scalar</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tile_count</td><td>no clue (not used in MOM?) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01311">1311</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">register_diag_field_expand_cmor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name<span class="comment"> !&lt; Name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name<span class="comment"> !&lt; Name of the diagnostic field</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: axes<span class="comment"> !&lt; Container w/ up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordtype">type</span>(time_type),  <span class="keywordtype">intent(in)</span> :: init_time<span class="comment"> !&lt; Time at which a field is first available?</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name<span class="comment"> !&lt; Long name of a field.</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: units<span class="comment"> !&lt; Units of a field.</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: standard_name<span class="comment"> !&lt; Standardized name associated with a field</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: missing_value<span class="comment"> !&lt; A value that indicates missing values.</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: range(2)<span class="comment"> !&lt; Valid range of a variable (not used in MOM?)</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask_variant<span class="comment"> !&lt; If true a logical mask must be provided with post_data calls (not used in MOM?)</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: verbose<span class="comment"> !&lt; If true, FMS is verbose (not used in MOM?)</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: do_not_log<span class="comment"> !&lt; If true, do not log something (not used in MOM?)</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span>:: err_msg<span class="comment"> !&lt; String into which an error message might be placed (not used in MOM?)</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: interp_method<span class="comment"> !&lt; If &#39;none&#39; indicates the field should not be interpolated as a scalar</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: tile_count<span class="comment"> !&lt; no clue (not used in MOM?)</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordtype">integer</span> :: fms_id, area_id</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="comment">! This gets the cell area associated with the grid location of this variable</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  area_id = axes%id_area</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">! Get the FMS diagnostic id</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(interp_method) .or. axes%is_h_point) <span class="keywordflow">then</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">! If interp_method is provided we must use it</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span> (area_id&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      fms_id = register_diag_field_fms(module_name, field_name, axes%handles, &amp;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                 init_time, long_name=long_name, units=units, missing_value=missing_value, &amp;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                 range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                 verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                 interp_method=interp_method, tile_count=tile_count, area=area_id)</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      fms_id = register_diag_field_fms(module_name, field_name, axes%handles, &amp;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                 init_time, long_name=long_name, units=units, missing_value=missing_value, &amp;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                 range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                 verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                 interp_method=interp_method, tile_count=tile_count)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">! If interp_method is not provided and the field is not at an h-point then interp_method=&#39;none&#39;</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">if</span> (area_id&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      fms_id = register_diag_field_fms(module_name, field_name, axes%handles, &amp;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                 init_time, long_name=long_name, units=units, missing_value=missing_value, &amp;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                 range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                 verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                 interp_method=<span class="stringliteral">&#39;none&#39;</span>, tile_count=tile_count, area=area_id)</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      fms_id = register_diag_field_fms(module_name, field_name, axes%handles, &amp;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                 init_time, long_name=long_name, units=units, missing_value=missing_value, &amp;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                 range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                 verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                 interp_method=<span class="stringliteral">&#39;none&#39;</span>, tile_count=tile_count)</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  register_diag_field_expand_axes = fms_id</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_aca4a32fea8dade9f51e076a56b9bad2b_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae50b35cba800ac5fd8975929fd2b9f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae50b35cba800ac5fd8975929fd2b9f4a">&#9670;&nbsp;</a></span>register_diag_field_expand_cmor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical function mom_diag_mediator::register_diag_field_expand_cmor </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>dm_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>init_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>mask_variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>do_not_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out), optional&#160;</td>
          <td class="paramname"><em>err_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>tile_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cell_methods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>x_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>y_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>v_cell_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>conversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>v_extensive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns True if either the native of CMOr version of the diagnostic were registered. Updates 'dm_id' after calling <a class="el" href="namespacemom__diag__mediator.html#aca4a32fea8dade9f51e076a56b9bad2b" title="Returns an FMS id from register_diag_field_fms (the diag_manager routine) after expanding axes (axes-...">register_diag_field_expand_axes()</a> for both native and CMOR variants of the field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dm_id</td><td>The diag_mediator ID for this diagnostic group</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">module_name</td><td>Name of this module, usually "ocean_model" or "ice_shelf_model"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the diagnostic field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Container w/ up to 3 integer handles that indicates axes for this field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init_time</td><td>Time at which a field is first available?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">long_name</td><td>Long name of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">units</td><td>Units of a field.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">standard_name</td><td>Standardized name associated with a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">missing_value</td><td>A value that indicates missing values.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">range</td><td>Valid range of a variable (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mask_variant</td><td>If true a logical mask must be provided with <a class="el" href="interfacemom__diag__mediator_1_1post__data.html">post_data</a> calls (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>If true, FMS is verbose (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_not_log</td><td>If true, do not log something (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err_msg</td><td>String into which an error message might be placed (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interp_method</td><td>If 'none' indicates the field should not be interpolated as a scalar</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tile_count</td><td>no clue (not used in MOM?)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_field_name</td><td>CMOR name of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_long_name</td><td>CMOR long name of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_units</td><td>CMOR units of a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmor_standard_name</td><td>CMOR standardized name associated with a field</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell_methods</td><td>String to append as cell_methods attribute. Use '' to have no attribute. If present, this overrides the default constructed from the default for each individual axis direction.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_cell_method</td><td>Specifies the cell method for the x-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y_cell_method</td><td>Specifies the cell method for the y-direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_cell_method</td><td>Specifies the cell method for the vertical direction. Use '' have no method.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conversion</td><td>A value to multiply data by before writing to file</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_extensive</td><td>True for vertically extensive fields (vertically integrated). Default/absent for intensive. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01159">1159</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l01371">add_diag_to_list()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l01396">attach_cell_methods()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00049">mom_error_handler::is_root_pe()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l02237">log_available_diag()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01311">register_diag_field_expand_axes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01048">register_diag_field()</a>.</p>
<div class="fragment"><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">intent(inout)</span> :: dm_id<span class="comment"> !&lt; The diag_mediator ID for this diagnostic group</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name<span class="comment"> !&lt; Name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name<span class="comment"> !&lt; Name of the diagnostic field</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordtype">type</span>(axes_grp), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: axes<span class="comment"> !&lt; Container w/ up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordtype">type</span>(time_type),  <span class="keywordtype">intent(in)</span> :: init_time<span class="comment"> !&lt; Time at which a field is first available?</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name<span class="comment"> !&lt; Long name of a field.</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: units<span class="comment"> !&lt; Units of a field.</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: standard_name<span class="comment"> !&lt; Standardized name associated with a field</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: missing_value<span class="comment"> !&lt; A value that indicates missing values.</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: range(2)<span class="comment"> !&lt; Valid range of a variable (not used in MOM?)</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask_variant<span class="comment"> !&lt; If true a logical mask must be provided with post_data calls (not used in MOM?)</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: verbose<span class="comment"> !&lt; If true, FMS is verbose (not used in MOM?)</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: do_not_log<span class="comment"> !&lt; If true, do not log something (not used in MOM?)</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span>:: err_msg<span class="comment"> !&lt; String into which an error message might be placed (not used in MOM?)</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: interp_method<span class="comment"> !&lt; If &#39;none&#39; indicates the field should not be interpolated as a scalar</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: tile_count<span class="comment"> !&lt; no clue (not used in MOM?)</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_field_name<span class="comment"> !&lt; CMOR name of a field</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_long_name<span class="comment"> !&lt; CMOR long name of a field</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_units<span class="comment"> !&lt; CMOR units of a field</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_standard_name<span class="comment"> !&lt; CMOR standardized name associated with a field</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cell_methods<span class="comment"> !&lt; String to append as cell_methods attribute. Use &#39;&#39; to have no attribute.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">                                                         !! If present, this overrides the default constructed from the default for</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">                                                         !! each individual axis direction.</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: x_cell_method<span class="comment"> !&lt; Specifies the cell method for the x-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: y_cell_method<span class="comment"> !&lt; Specifies the cell method for the y-direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: v_cell_method<span class="comment"> !&lt; Specifies the cell method for the vertical direction. Use &#39;&#39; have no method.</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: conversion<span class="comment"> !&lt; A value to multiply data by before writing to file</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: v_extensive<span class="comment"> !&lt; True for vertically extensive fields (vertically integrated). Default/absent for intensive.</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordtype">real</span> :: mom_missing_value</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">pointer</span> :: diag_cs</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: this_diag =&gt; null()</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keywordtype">integer</span> :: fms_id, fms_xyave_id</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordtype">character(len=256)</span> :: posted_cmor_units, posted_cmor_standard_name, posted_cmor_long_name, cm_string, msg</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  mom_missing_value = axes%diag_cs%missing_value</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(missing_value)) mom_missing_value = missing_value</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  register_diag_field_expand_cmor = .false.</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  diag_cs =&gt; axes%diag_cs</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">! Set up the &#39;primary&#39; diagnostic, first get an underlying FMS id</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  fms_id = register_diag_field_expand_axes(module_name, field_name, axes, init_time, &amp;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;             long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;             range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;             verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;             interp_method=interp_method, tile_count=tile_count)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keyword">call </span>attach_cell_methods(fms_id, axes, cm_string, &amp;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                           cell_methods, x_cell_method, y_cell_method, v_cell_method, &amp;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                           v_extensive=v_extensive)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    msg = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) msg = <span class="stringliteral">&#39;CMOR equivalent is &quot;&#39;</span>//trim(cmor_field_name)//<span class="stringliteral">&#39;&quot;&#39;</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keyword">call </span>log_available_diag(fms_id&gt;0, module_name, field_name, cm_string, &amp;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                            msg, diag_cs, long_name, units, standard_name)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="comment">! Associated horizontally area-averaged diagnostic</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  fms_xyave_id = diag_field_not_found</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">associated</span>(axes%xyave_axes)) <span class="keywordflow">then</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    fms_xyave_id = register_diag_field_expand_axes(module_name, trim(field_name)//<span class="stringliteral">&#39;_xyave&#39;</span>, &amp;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;             axes%xyave_axes, init_time, &amp;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;             long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;             range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;             verbose=verbose, do_not_log=do_not_log, err_msg=err_msg, &amp;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;             interp_method=interp_method, tile_count=tile_count)</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keyword">call </span>attach_cell_methods(fms_xyave_id, axes%xyave_axes, cm_string, &amp;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                             cell_methods, v_cell_method, v_extensive=v_extensive)</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      msg = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) msg = <span class="stringliteral">&#39;CMOR equivalent is &quot;&#39;</span>//trim(cmor_field_name)//<span class="stringliteral">&#39;_xyave&quot;&#39;</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keyword">call </span>log_available_diag(fms_xyave_id&gt;0, module_name, trim(field_name)//<span class="stringliteral">&#39;_xyave&#39;</span>, cm_string, &amp;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                              msg, diag_cs, long_name, units, standard_name)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  this_diag =&gt; null()</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">if</span> (fms_id /= diag_field_not_found .or. fms_xyave_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keyword">call </span>add_diag_to_list(diag_cs, dm_id, fms_id, this_diag, axes, module_name, field_name, msg)</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    this_diag%fms_xyave_diag_id = fms_xyave_id</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(v_extensive)) this_diag%v_extensive = v_extensive</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(conversion)) this_diag%conversion_factor = conversion</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    register_diag_field_expand_cmor = .true.</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="comment">! For the CMOR variation of the above diagnostic</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) <span class="keywordflow">then</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">! Fallback values for strings set to &quot;NULL&quot;</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    posted_cmor_units = <span class="stringliteral">&quot;not provided&quot;</span>           <span class="comment">!</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    posted_cmor_standard_name = <span class="stringliteral">&quot;not provided&quot;</span>   <span class="comment">! Values might be able to be replaced with a CS%missing field?</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    posted_cmor_long_name = <span class="stringliteral">&quot;not provided&quot;</span>       <span class="comment">!</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">! If attributes are present for MOM variable names, use them first for the register_diag_field</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">! call for CMOR verison of the variable</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(units)) posted_cmor_units = units</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(standard_name)) posted_cmor_standard_name = standard_name</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(long_name)) posted_cmor_long_name = long_name</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">! If specified in the call to register_diag_field, override attributes with the CMOR versions</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_units)) posted_cmor_units = cmor_units</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_standard_name)) posted_cmor_standard_name = cmor_standard_name</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_long_name)) posted_cmor_long_name = cmor_long_name</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    fms_id = register_diag_field_expand_axes(module_name, cmor_field_name, axes, init_time,    &amp;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;               long_name=trim(posted_cmor_long_name), units=trim(posted_cmor_units),                    &amp;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;               missing_value=mom_missing_value, range=range, mask_variant=mask_variant,                 &amp;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;               standard_name=trim(posted_cmor_standard_name), verbose=verbose, do_not_log=do_not_log,   &amp;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;               err_msg=err_msg, interp_method=interp_method, tile_count=tile_count)</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keyword">call </span>attach_cell_methods(fms_id, axes, cm_string, &amp;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                             cell_methods, x_cell_method, y_cell_method, v_cell_method, &amp;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                             v_extensive=v_extensive)</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      msg = <span class="stringliteral">&#39;native name is &quot;&#39;</span>//trim(field_name)//<span class="stringliteral">&#39;&quot;&#39;</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keyword">call </span>log_available_diag(fms_id&gt;0, module_name, cmor_field_name, cm_string, &amp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                              msg, diag_cs, posted_cmor_long_name, posted_cmor_units, &amp;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                              posted_cmor_standard_name)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">! Associated horizontally area-averaged diagnostic</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    fms_xyave_id = diag_field_not_found</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">associated</span>(axes%xyave_axes)) <span class="keywordflow">then</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      fms_xyave_id = register_diag_field_expand_axes(module_name, trim(cmor_field_name)//<span class="stringliteral">&#39;_xyave&#39;</span>, &amp;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;               axes%xyave_axes, init_time, &amp;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;               long_name=trim(posted_cmor_long_name), units=trim(posted_cmor_units),                    &amp;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;               missing_value=mom_missing_value, range=range, mask_variant=mask_variant,                 &amp;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;               standard_name=trim(posted_cmor_standard_name), verbose=verbose, do_not_log=do_not_log,   &amp;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;               err_msg=err_msg, interp_method=interp_method, tile_count=tile_count)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keyword">call </span>attach_cell_methods(fms_xyave_id, axes%xyave_axes, cm_string, &amp;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                               cell_methods, v_cell_method, v_extensive=v_extensive)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        msg = <span class="stringliteral">&#39;native name is &quot;&#39;</span>//trim(field_name)//<span class="stringliteral">&#39;_xyave&quot;&#39;</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keyword">call </span>log_available_diag(fms_xyave_id&gt;0, module_name, trim(cmor_field_name)//<span class="stringliteral">&#39;_xyave&#39;</span>, cm_string, &amp;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                msg, diag_cs, posted_cmor_long_name, posted_cmor_units, &amp;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                posted_cmor_standard_name)</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    this_diag =&gt; null()</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">if</span> (fms_id /= diag_field_not_found .or. fms_xyave_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keyword">call </span>add_diag_to_list(diag_cs, dm_id, fms_id, this_diag, axes, module_name, field_name, msg)</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      this_diag%fms_xyave_diag_id = fms_xyave_id</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(v_extensive)) this_diag%v_extensive = v_extensive</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">present</span>(conversion)) this_diag%conversion_factor = conversion</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      register_diag_field_expand_cmor = .true.</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae50b35cba800ac5fd8975929fd2b9f4a_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_ae50b35cba800ac5fd8975929fd2b9f4a_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="afb4254e1cfbbcfc43028f14915173f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb4254e1cfbbcfc43028f14915173f80">&#9670;&nbsp;</a></span>register_scalar_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mom_diag_mediator::register_scalar_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(time_type), intent(in)&#160;</td>
          <td class="paramname"><em>init_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>do_not_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(out), optional&#160;</td>
          <td class="paramname"><em>err_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_standard_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01486">1486</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l02211">alloc_diag_with_id()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l02165">get_new_diag_id()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00049">mom_error_handler::is_root_pe()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l02237">log_available_diag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keywordtype">integer</span> :: register_scalar_field</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name, field_name</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordtype">type</span>(time_type),  <span class="keywordtype">intent(in)</span> :: init_time</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),  <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name, units, standard_name</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: missing_value, range(2)</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: do_not_log</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(out)</span>:: err_msg</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: interp_method</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_field_name, cmor_long_name</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_units, cmor_standard_name</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="comment">! Output:    An integer handle for a diagnostic array.</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">! Arguments:</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">!  (in)      module_name   - name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;.</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">!  (in)      field_name    - name of the diagnostic field.</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">!  (in)      init_time     - time at which a field is first available?</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">!  (inout)   diag_cs     - structure used to regulate diagnostic output</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">!  (in,opt)  long_name     - long name of a field</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">!  (in,opt)  units         - units of a field</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">!  (in,opt)  missing_value - indicates missing values</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">!  (in,opt)  standard_name - standardized name associated with a field</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">! Following params have yet to be used in MOM.</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="comment">!  (in,opt)  range         - valid range of a variable</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">!  (in,opt)  verbose       - If true, FMS is verbosed</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">!  (in,opt)  do_not_log    - If true, do not log something</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="comment">!  (out,opt) err_msg       - character string into which an error message might be placed</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="comment">!  (in,opt)  interp_method - If &#39;none&#39; indicates the field should not be interpolated as a scalar</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="comment">!  (in,opt)  tile_count    - no clue</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keywordtype">real</span> :: mom_missing_value</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keywordtype">integer</span> :: dm_id, fms_id</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null(), cmor_diag =&gt; null()</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordtype">character(len=256)</span> :: posted_cmor_units, posted_cmor_standard_name, posted_cmor_long_name</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  mom_missing_value = diag_cs%missing_value</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(missing_value)) mom_missing_value = missing_value</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  dm_id = -1</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  diag =&gt; null()</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  cmor_diag =&gt; null()</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  fms_id = register_diag_field_fms(module_name, field_name, init_time, &amp;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      range=range, standard_name=standard_name, do_not_log=do_not_log, err_msg=err_msg)</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="keywordflow">if</span> (fms_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    dm_id = get_new_diag_id(diag_cs)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keyword">call </span>alloc_diag_with_id(dm_id, diag_cs, diag)</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keyword">call </span>assert(<span class="keyword">associated</span>(diag), <span class="stringliteral">&#39;register_scalar_field: diag allocation failed&#39;</span>)</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    diag%fms_diag_id = fms_id</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    diag%debug_str = trim(module_name)//<span class="stringliteral">&quot;-&quot;</span>//trim(field_name)</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) <span class="keywordflow">then</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="comment">! Fallback values for strings set to &quot;not provided&quot;</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    posted_cmor_units = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    posted_cmor_standard_name = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    posted_cmor_long_name = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">! If attributes are present for MOM variable names, use them first for the register_static_field</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">! call for CMOR verison of the variable</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(units)) posted_cmor_units = units</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(standard_name)) posted_cmor_standard_name = standard_name</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(long_name)) posted_cmor_long_name = long_name</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">! If specified in the call to register_static_field, override attributes with the CMOR versions</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_units)) posted_cmor_units = cmor_units</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_standard_name)) posted_cmor_standard_name = cmor_standard_name</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_long_name)) posted_cmor_long_name = cmor_long_name</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    fms_id = register_diag_field_fms(module_name, cmor_field_name, init_time, &amp;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;       long_name=trim(posted_cmor_long_name), units=trim(posted_cmor_units), &amp;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;       missing_value=mom_missing_value, range=range, &amp;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;       standard_name=trim(posted_cmor_standard_name), do_not_log=do_not_log, err_msg=err_msg)</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (fms_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordflow">if</span> (dm_id == -1) <span class="keywordflow">then</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        dm_id = get_new_diag_id(diag_cs)</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keyword">call </span>alloc_diag_with_id(dm_id, diag_cs, cmor_diag)</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      cmor_diag%fms_diag_id = fms_id</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      cmor_diag%debug_str = trim(module_name)//<span class="stringliteral">&quot;-&quot;</span>//trim(cmor_field_name)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="comment">! Document diagnostics in list of available diagnostics</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keyword">call </span>log_available_diag(<span class="keyword">associated</span>(diag), module_name, field_name, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, diag_cs, &amp;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                            long_name, units, standard_name)</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) <span class="keywordflow">then</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keyword">call </span>log_available_diag(<span class="keyword">associated</span>(cmor_diag), module_name, cmor_field_name, &amp;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                              <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, diag_cs, posted_cmor_long_name, posted_cmor_units, &amp;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                              posted_cmor_standard_name)</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  register_scalar_field = dm_id</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_afb4254e1cfbbcfc43028f14915173f80_cgraph.svg" width="100%" height="515"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="abe591ed2565e9f026c5be055bc2fc0b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe591ed2565e9f026c5be055bc2fc0b7">&#9670;&nbsp;</a></span>register_static_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public mom_diag_mediator::register_static_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>module_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>missing_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>mask_variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>do_not_log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>interp_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>tile_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_long_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="version__variable_8h.html#acda997fe1761de4c6bca0f27dc786964">character</a>(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>cmor_standard_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>area</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a static diagnostic, returning an integer handle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">area</td><td>fms_id for area_t </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l01591">1591</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l02211">alloc_diag_with_id()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00178">mom_error_handler::assert()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l02165">get_new_diag_id()</a>, <a class="el" href="MOM__error__handler_8F90_source.html#l00049">mom_error_handler::is_root_pe()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l02237">log_available_diag()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__geothermal_8F90_source.html#l00383">mom_geothermal::geothermal_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordtype">integer</span> :: register_static_field</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: module_name, field_name</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordtype">type</span>(axes_grp),   <span class="keywordtype">intent(in)</span> :: axes</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: long_name, units, standard_name</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keywordtype">real</span>,             <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: missing_value, range(2)</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keywordtype">logical</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: mask_variant, do_not_log</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: interp_method</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: tile_count</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_field_name, cmor_long_name</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: cmor_units, cmor_standard_name</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordtype">integer</span>,          <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: area<span class="comment"> !&lt; fms_id for area_t</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">! Output:    An integer handle for a diagnostic array.</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">! Arguments:</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="comment">!  (in)      module_name   - name of this module, usually &quot;ocean_model&quot; or &quot;ice_shelf_model&quot;.</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="comment">!  (in)      field_name    - name of the diagnostic field</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">!  (in)      axes          - container with up to 3 integer handles that indicates axes for this field</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">!  (in,opt)  long_name     - long name of a field</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="comment">!  (in,opt)  units         - units of a field</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">!  (in,opt)  missing_value - A value that indicates missing values.</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">!  (in,opt)  standard_name - standardized name associated with a field</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="comment">! Following params have yet to be used in MOM.</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">!  (in,opt)  range          - valid range of a variable</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="comment">!  (in,opt)  mask_variant   - If true a logical mask must be provided with post_data calls</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="comment">!  (in,opt)  do_not_log     - If true, do not log something</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">!  (in,opt)  interp_method  - If &#39;none&#39; indicates the field should not be interpolated as a scalar</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">!  (in,opt)  tile_count     - no clue</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordtype">real</span> :: mom_missing_value</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">pointer</span> :: diag_cs</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span> :: diag =&gt; null(), cmor_diag =&gt; null()</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="keywordtype">integer</span> :: dm_id, fms_id, cmor_id</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordtype">character(len=256)</span> :: posted_cmor_units, posted_cmor_standard_name, posted_cmor_long_name</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  mom_missing_value = axes%diag_cs%missing_value</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordflow">if</span>(<span class="keyword">present</span>(missing_value)) mom_missing_value = missing_value</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  diag_cs =&gt; axes%diag_cs</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  dm_id = -1</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  diag =&gt; null()</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  cmor_diag =&gt; null()</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  fms_id = register_static_field_fms(module_name, field_name, axes%handles, &amp;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;         long_name=long_name, units=units, missing_value=mom_missing_value, &amp;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;         range=range, mask_variant=mask_variant, standard_name=standard_name, &amp;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;         do_not_log=do_not_log, &amp;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;         interp_method=interp_method, tile_count=tile_count, area=area)</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">if</span> (fms_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    dm_id = get_new_diag_id(diag_cs)</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keyword">call </span>alloc_diag_with_id(dm_id, diag_cs, diag)</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keyword">call </span>assert(<span class="keyword">associated</span>(diag), <span class="stringliteral">&#39;register_static_field: diag allocation failed&#39;</span>)</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    diag%fms_diag_id = fms_id</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    diag%debug_str = trim(module_name)//<span class="stringliteral">&quot;-&quot;</span>//trim(field_name)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) <span class="keywordflow">then</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="comment">! Fallback values for strings set to &quot;not provided&quot;</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    posted_cmor_units = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    posted_cmor_standard_name = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    posted_cmor_long_name = <span class="stringliteral">&quot;not provided&quot;</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="comment">! If attributes are present for MOM variable names, use them first for the register_static_field</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">! call for CMOR verison of the variable</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(units)) posted_cmor_units = units</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(standard_name)) posted_cmor_standard_name = standard_name</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(long_name)) posted_cmor_long_name = long_name</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">! If specified in the call to register_static_field, override attributes with the CMOR versions</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_units)) posted_cmor_units = cmor_units</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_standard_name)) posted_cmor_standard_name = cmor_standard_name</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_long_name)) posted_cmor_long_name = cmor_long_name</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    fms_id = register_static_field_fms(module_name, cmor_field_name, &amp;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      axes%handles, long_name=trim(posted_cmor_long_name), units=trim(posted_cmor_units), &amp;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      missing_value=mom_missing_value, range=range, mask_variant=mask_variant,            &amp;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      standard_name=trim(posted_cmor_standard_name), do_not_log=do_not_log,               &amp;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      interp_method=interp_method, tile_count=tile_count, area=area)</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordflow">if</span> (fms_id /= diag_field_not_found) <span class="keywordflow">then</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="keywordflow">if</span> (dm_id == -1) <span class="keywordflow">then</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        dm_id = get_new_diag_id(diag_cs)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keyword">call </span>alloc_diag_with_id(dm_id, diag_cs, cmor_diag)</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      cmor_diag%fms_diag_id = fms_id</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      cmor_diag%debug_str = trim(module_name)//<span class="stringliteral">&quot;-&quot;</span>//trim(cmor_field_name)</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">! Document diagnostics in list of available diagnostics</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordflow">if</span> (is_root_pe() .and. diag_cs%doc_unit &gt; 0) <span class="keywordflow">then</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keyword">call </span>log_available_diag(<span class="keyword">associated</span>(diag), module_name, field_name, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, diag_cs, &amp;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                            long_name, units, standard_name)</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(cmor_field_name)) <span class="keywordflow">then</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keyword">call </span>log_available_diag(<span class="keyword">associated</span>(cmor_diag), module_name, cmor_field_name, &amp;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                              <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, diag_cs, posted_cmor_long_name, posted_cmor_units, &amp;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                              posted_cmor_standard_name)</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  register_static_field = dm_id</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_abe591ed2565e9f026c5be055bc2fc0b7_cgraph.svg" width="100%" height="515"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_abe591ed2565e9f026c5be055bc2fc0b7_icgraph.svg" width="615" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4d8d23e602166167b393e19453ded5bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8d23e602166167b393e19453ded5bf">&#9670;&nbsp;</a></span>set_axes_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::set_axes_info </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(verticalgrid_type), intent(in)&#160;</td>
          <td class="paramname"><em>GV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(param_file_type), intent(in)&#160;</td>
          <td class="paramname"><em>param_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>set_vertical</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up diagnostics axes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Ocean grid structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gv</td><td>ocean vertical grid structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_file</td><td>Parameter file structure</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag_cs</td><td>Diagnostics control structure</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">set_vertical</td><td>If true or missing, set up vertical axes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00213">213</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">References <a class="el" href="MOM__diag__mediator_8F90_source.html#l00434">define_axes_group()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM_8F90_source.html#l01480">mom::initialize_mom()</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(inout)</span> :: g<span class="comment"> !&lt; Ocean grid structure</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">type</span>(verticalgrid_type), <span class="keywordtype">intent(in)</span>  :: gv<span class="comment"> !&lt; ocean vertical grid structure</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">type</span>(param_file_type), <span class="keywordtype">intent(in)</span>    :: param_file<span class="comment"> !&lt; Parameter file structure</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),       <span class="keywordtype">intent(inout)</span> :: diag_cs<span class="comment"> !&lt; Diagnostics control structure</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">optional</span>,     <span class="keywordtype">intent(in)</span>    :: set_vertical<span class="comment"> !&lt; If true or missing, set up</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">                                                       !! vertical axes</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">! Local variables</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">integer</span> :: id_xq, id_yq, id_zl, id_zi, id_xh, id_yh</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">integer</span> :: i, k, nz</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">real</span> :: zlev(gv%ke), zinter(gv%ke+1)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">logical</span> :: set_vert</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  set_vert = .true. ; <span class="keywordflow">if</span> (<span class="keyword">present</span>(set_vertical)) set_vert = set_vertical</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(g%symmetric) <span class="keywordflow">then</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    id_xq = diag_axis_init(<span class="stringliteral">&#39;xq&#39;</span>, g%gridLonB(g%isgB:g%iegB), g%x_axis_units, <span class="stringliteral">&#39;x&#39;</span>, &amp;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              <span class="stringliteral">&#39;q point nominal longitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    id_yq = diag_axis_init(<span class="stringliteral">&#39;yq&#39;</span>, g%gridLatB(g%jsgB:g%jegB), g%y_axis_units, <span class="stringliteral">&#39;y&#39;</span>, &amp;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              <span class="stringliteral">&#39;q point nominal latitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    id_xq = diag_axis_init(<span class="stringliteral">&#39;xq&#39;</span>, g%gridLonB(g%isg:g%ieg), g%x_axis_units, <span class="stringliteral">&#39;x&#39;</span>, &amp;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              <span class="stringliteral">&#39;q point nominal longitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    id_yq = diag_axis_init(<span class="stringliteral">&#39;yq&#39;</span>, g%gridLatB(g%jsg:g%jeg), g%y_axis_units, <span class="stringliteral">&#39;y&#39;</span>, &amp;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              <span class="stringliteral">&#39;q point nominal latitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  id_xh = diag_axis_init(<span class="stringliteral">&#39;xh&#39;</span>, g%gridLonT(g%isg:g%ieg), g%x_axis_units, <span class="stringliteral">&#39;x&#39;</span>, &amp;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;              <span class="stringliteral">&#39;h point nominal longitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  id_yh = diag_axis_init(<span class="stringliteral">&#39;yh&#39;</span>, g%gridLatT(g%jsg:g%jeg), g%y_axis_units, <span class="stringliteral">&#39;y&#39;</span>, &amp;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;              <span class="stringliteral">&#39;h point nominal latitude&#39;</span>, domain2=g%Domain%mpp_domain)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> (set_vert) <span class="keywordflow">then</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    nz = gv%ke</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    zinter(1:nz+1) = gv%sInterface(1:nz+1)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    zlev(1:nz) = gv%sLayer(1:nz)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    id_zl = diag_axis_init(<span class="stringliteral">&#39;zl&#39;</span>, zlev, trim(gv%zAxisUnits), <span class="stringliteral">&#39;z&#39;</span>, &amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                           <span class="stringliteral">&#39;Layer &#39;</span>//trim(gv%zAxisLongName),     &amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                           direction=gv%direction)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    id_zi = diag_axis_init(<span class="stringliteral">&#39;zi&#39;</span>, zinter, trim(gv%zAxisUnits), <span class="stringliteral">&#39;z&#39;</span>, &amp;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                           <span class="stringliteral">&#39;Interface &#39;</span>//trim(gv%zAxisLongName),   &amp;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                           direction=gv%direction)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    id_zl = -1 ; id_zi = -1</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">! Vertical axes for the interfaces and layers</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_zi /), diag_cs%axesZi, &amp;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;       v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, is_interface=.true.)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_zl /), diag_cs%axesZL, &amp;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;       v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, is_layer=.true.)</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">! Axis groupings for the model layers</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yh, id_zl /), diag_cs%axesTL, &amp;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;       is_h_point=.true., is_layer=.true., xyave_axes=diag_cs%axesZL)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yq, id_zl /), diag_cs%axesBL, &amp;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;       is_q_point=.true., is_layer=.true.)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yh, id_zl /), diag_cs%axesCuL, &amp;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;       is_u_point=.true., is_layer=.true., xyave_axes=diag_cs%axesZL)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yq, id_zl /), diag_cs%axesCvL, &amp;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;       is_v_point=.true., is_layer=.true., xyave_axes=diag_cs%axesZL)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">! Axis groupings for the model interfaces</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yh, id_zi /), diag_cs%axesTi, &amp;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;       is_h_point=.true., is_interface=.true., xyave_axes=diag_cs%axesZi)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yq, id_zi /), diag_cs%axesBi, &amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;       is_q_point=.true., is_interface=.true.)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yh, id_zi /), diag_cs%axesCui, &amp;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;       is_u_point=.true., is_interface=.true., xyave_axes=diag_cs%axesZi)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yq, id_zi /), diag_cs%axesCvi, &amp;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;       is_v_point=.true., is_interface=.true., xyave_axes=diag_cs%axesZi)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">! Axis groupings for 2-D arrays</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yh /), diag_cs%axesT1, &amp;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, is_h_point=.true.)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yq /), diag_cs%axesB1, &amp;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, is_q_point=.true.)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yh /), diag_cs%axesCu1, &amp;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;       x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, is_u_point=.true.)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yq /), diag_cs%axesCv1, &amp;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;       x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, is_v_point=.true.)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (diag_cs%num_diag_coords&gt;0) <span class="keywordflow">then</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesZL(diag_cs%num_diag_coords))</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesTL(diag_cs%num_diag_coords))</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesBL(diag_cs%num_diag_coords))</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesCuL(diag_cs%num_diag_coords))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesCvL(diag_cs%num_diag_coords))</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesZi(diag_cs%num_diag_coords))</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesTi(diag_cs%num_diag_coords))</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesBi(diag_cs%num_diag_coords))</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesCui(diag_cs%num_diag_coords))</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keyword">allocate</span>(diag_cs%remap_axesCvi(diag_cs%num_diag_coords))</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">do</span> i=1, diag_cs%num_diag_coords</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">! For each possible diagnostic coordinate</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">call </span>diag_remap_configure_axes(diag_cs%diag_remap_cs(i), gv, param_file)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">! This vertical coordinate has been configured so can be used.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (diag_remap_axes_configured(diag_cs%diag_remap_cs(i))) <span class="keywordflow">then</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">! This fetches the 1D-axis id for layers and interfaces and overwrite</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">! id_zl and id_zi from above. It also returns the number of layers.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keyword">call </span>diag_remap_get_axes_info(diag_cs%diag_remap_cs(i), nz, id_zl, id_zi)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">! Axes for z layers</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_zl /), diag_cs%remap_axesZL(i), &amp;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;           v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;           is_h_point=.true., is_layer=.true., is_native=.false., needs_remapping=.true.)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yh, id_zl /), diag_cs%remap_axesTL(i), &amp;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;           x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;           is_h_point=.true., is_layer=.true., is_native=.false., needs_remapping=.true., &amp;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;           xyave_axes=diag_cs%remap_axesZL(i))</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       <span class="comment">!! \note Remapping for B points is not yet implemented so needs_remapping is not provided for remap_axesBL</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yq, id_zl /), diag_cs%remap_axesBL(i), &amp;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;           x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;           is_q_point=.true., is_layer=.true., is_native=.false.)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yh, id_zl /), diag_cs%remap_axesCuL(i), &amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;           x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;           is_u_point=.true., is_layer=.true., is_native=.false., needs_remapping=.true., &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;           xyave_axes=diag_cs%remap_axesZL(i))</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yq, id_zl /), diag_cs%remap_axesCvL(i), &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;           x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, &amp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;           is_v_point=.true., is_layer=.true., is_native=.false., needs_remapping=.true., &amp;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;           xyave_axes=diag_cs%remap_axesZL(i))</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">! Axes for z interfaces</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_zi /), diag_cs%remap_axesZi(i), &amp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;           v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;           is_h_point=.true., is_interface=.true., is_native=.false., needs_interpolating=.true.)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yh, id_zi /), diag_cs%remap_axesTi(i), &amp;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;           x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;           is_h_point=.true., is_interface=.true., is_native=.false., needs_interpolating=.true., &amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;           xyave_axes=diag_cs%remap_axesZi(i))</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">!! \note Remapping for B points is not yet implemented so needs_remapping is not provided for remap_axesBi</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yq, id_zi /), diag_cs%remap_axesBi(i), &amp;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;           x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;           is_q_point=.true., is_interface=.true., is_native=.false.)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xq, id_yh, id_zi /), diag_cs%remap_axesCui(i), &amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;           x_cell_method=<span class="stringliteral">&#39;point&#39;</span>, y_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;           is_u_point=.true., is_interface=.true., is_native=.false., &amp;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;           needs_interpolating=.true., xyave_axes=diag_cs%remap_axesZi(i))</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keyword">call </span>define_axes_group(diag_cs, (/ id_xh, id_yq, id_zi /), diag_cs%remap_axesCvi(i), &amp;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;           nz=nz, vertical_coordinate_number=i, &amp;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;           x_cell_method=<span class="stringliteral">&#39;mean&#39;</span>, y_cell_method=<span class="stringliteral">&#39;point&#39;</span>, v_cell_method=<span class="stringliteral">&#39;point&#39;</span>, &amp;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;           is_v_point=.true., is_interface=.true., is_native=.false., &amp;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;           needs_interpolating=.true., xyave_axes=diag_cs%remap_axesZi(i))</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="keywordflow">  enddo</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a4d8d23e602166167b393e19453ded5bf_cgraph.svg" width="100%" height="378"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a4d8d23e602166167b393e19453ded5bf_icgraph.svg" width="483" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a085f313357879a914af6450f2ab8ec79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a085f313357879a914af6450f2ab8ec79">&#9670;&nbsp;</a></span>set_diag_mask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mom_diag_mediator::set_diag_mask </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__type.html">diag_type</a>), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>diag_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1axes__grp.html">axes_grp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>axes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Associates the mask pointers within diag with the appropriate mask based on the axes group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">diag_cs</td><td>Diag_mediator control structure</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">diag</td><td>This diag type</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">axes</td><td>Axes group </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l02113">2113</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01371">add_diag_to_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl), <span class="keywordtype">target</span>, <span class="keywordtype">intent(in)</span> :: diag_cs<span class="comment"> !&lt; Diag_mediator control structure</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keywordtype">type</span>(diag_type), <span class="keywordtype">pointer</span>, <span class="keywordtype">intent(inout)</span> :: diag<span class="comment"> !&lt; This diag type</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordtype">type</span>(axes_grp),  <span class="keywordtype">intent(in)</span> :: axes<span class="comment"> !&lt; Axes group</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  diag%mask2d =&gt; null()</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  diag%mask3d =&gt; null()</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="keywordflow">if</span> (axes%rank .eq. 3) <span class="keywordflow">then</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">if</span> (axes%is_layer) <span class="keywordflow">then</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <span class="keywordflow">if</span> (axes%is_h_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dTL</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_q_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dBL</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_u_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dCuL</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_v_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dCvL</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">elseif</span> (axes%is_interface) <span class="keywordflow">then</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <span class="keywordflow">if</span> (axes%is_h_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dTi</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_q_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dBi</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_u_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dCui</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="keywordflow">elseif</span> (axes%is_v_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        diag%mask3d =&gt; diag_cs%mask3dCvi</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="comment">!call assert(associated(diag%mask3d), &quot;set_diag_mask: Invalid 3d axes id.&quot;// &amp;</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">!                                     &quot; diag:&quot;//diag%debug_str)</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">elseif</span>(axes%rank .eq. 2) <span class="keywordflow">then</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordflow">if</span> (axes%is_h_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      diag%mask2d =&gt;  diag_cs%mask2dT</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">elseif</span> (axes%is_q_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      diag%mask2d =&gt;  diag_cs%mask2dBu</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordflow">elseif</span> (axes%is_u_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        diag%mask2d =&gt;  diag_cs%mask2dCu</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordflow">elseif</span> (axes%is_v_point) <span class="keywordflow">then</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        diag%mask2d =&gt;  diag_cs%mask2dCv</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">!call assert(associated(diag%mask2d), &quot;set_diag_mask.F90: Invalid 2d axes id.&quot;// &amp;</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">!                                     &quot; diag:&quot;//diag%debug_str)</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="keywordflow">  endif</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="namespacemom__diag__mediator_a085f313357879a914af6450f2ab8ec79_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a36d062ce991a3bd7250b3224e6508eb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36d062ce991a3bd7250b3224e6508eb5">&#9670;&nbsp;</a></span>set_diag_mediator_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mom_diag_mediator::set_diag_mediator_grid </td>
          <td>(</td>
          <td class="paramtype">type(ocean_grid_type), intent(inout)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmom__diag__mediator_1_1diag__ctrl.html">diag_ctrl</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>diag_cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>The ocean's grid structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00501">501</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordtype">type</span>(ocean_grid_type), <span class="keywordtype">intent(inout)</span> :: g<span class="comment">    !&lt; The ocean&#39;s grid structure</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">type</span>(diag_ctrl),  <span class="keywordtype">intent(inout)</span> :: diag_cs</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">! Arguments:</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">!  (inout)    G   - ocean grid structure</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">!  (inout)   diag - structure used to regulate diagnostic output</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  diag_cs%is = g%isc - (g%isd-1) ; diag_cs%ie = g%iec - (g%isd-1)</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  diag_cs%js = g%jsc - (g%jsd-1) ; diag_cs%je = g%jec - (g%jsd-1)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  diag_cs%isd = g%isd ; diag_cs%ied = g%ied</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  diag_cs%jsd = g%jsd ; diag_cs%jed = g%jed</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="affaf7f9c1f9fc0c35f4a41c9b30b04e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affaf7f9c1f9fc0c35f4a41c9b30b04e6">&#9670;&nbsp;</a></span>id_clock_diag_grid_updates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer mom_diag_mediator::id_clock_diag_grid_updates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">207</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01823">diag_mediator_init()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l01968">diag_update_remap_grids()</a>.</p>

</div>
</div>
<a id="a882fc994662be43d067bb1f59a2662bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882fc994662be43d067bb1f59a2662bb">&#9670;&nbsp;</a></span>id_clock_diag_mediator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer mom_diag_mediator::id_clock_diag_mediator</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">207</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01823">diag_mediator_init()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00516">post_data_0d()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00553">post_data_1d_k()</a>, <a class="el" href="MOM__diag__mediator_8F90_source.html#l00590">post_data_2d()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00712">post_data_3d()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">integer</span> :: id_clock_diag_mediator, id_clock_diag_remap, id_clock_diag_grid_updates</div></div><!-- fragment -->
</div>
</div>
<a id="a8a8e75119f340f174cfef580ded1dd79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a8e75119f340f174cfef580ded1dd79">&#9670;&nbsp;</a></span>id_clock_diag_remap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer mom_diag_mediator::id_clock_diag_remap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MOM__diag__mediator_8F90_source.html#l00207">207</a> of file <a class="el" href="MOM__diag__mediator_8F90_source.html">MOM_diag_mediator.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="MOM__diag__mediator_8F90_source.html#l01823">diag_mediator_init()</a>, and <a class="el" href="MOM__diag__mediator_8F90_source.html#l00712">post_data_3d()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemom__diag__mediator.html">mom_diag_mediator</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
